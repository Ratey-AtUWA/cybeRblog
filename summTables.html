<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Andrew Rate" />

<meta name="date" content="2024-04-23" />

<title>Counting samples with R</title>

<script src="summTables_files/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="summTables_files/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="summTables_files/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="summTables_files/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="summTables_files/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="summTables_files/navigation-1.1/tabsets.js"></script>
<link href="summTables_files/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="summTables_files/highlightjs-9.12.0/highlight.js"></script>
<link href="summTables_files/tabwid-1.1.0/tabwid.css" rel="stylesheet" />
<link href="summTables_files/tabwid-1.1.0/scrool.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>



<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div id="header">



<h1 class="title toc-ignore">Counting samples with R</h1>
<h4 class="author">Andrew Rate</h4>
<h4 class="date">2024-04-23</h4>

</div>


<div id="summary-statistics-tables-which-include-sample-counts-above-environmental-thresholds" class="section level2">
<h2>Summary statistics tables which include sample counts above environmental thresholds</h2>
<p>Load the R packages we need and set a default table style (‘<code>theme</code>’):</p>
<pre class="r"><code>library(RcmdrMisc)
library(flextable)
  set_flextable_defaults(font.family = &quot;Arial&quot;, font.size = 11, 
                       theme_fun = &quot;theme_booktabs&quot;, padding = 1)
library(officer)</code></pre>
</div>
<div id="introduction" class="section level2">
<h2>Introduction</h2>
<p>In environmental reporting it’s common to produce tables containing statistical
summaries of the variables which have been measured at a particular location or
in a specific environment. The statistical parameters presented often include
basic statistics such as mean, median, standard deviation, minimum, and maximum.
In many environmental contexts (<em>e.g</em>. assessing environments for pollution or
contamination) it’s also very useful to know if any samples have concentrations
of contaminants that exceed environmental thresholds, and if so, how many.</p>
<p>The first code chunk (above) shows that we will use the <code>RcmdrMisc</code> package, as
it contains the useful <code>numSummary()</code> function, and the <code>flextable</code> package for
producing nicely-formatted tables. We also load the <code>officer</code> package to
make use of some formatting options in <code>flextable</code>. The rest of the code just
makes use of function in base R.</p>
</div>
<div id="importing-environmental-threshold-data" class="section level2">
<h2>Importing environmental threshold data</h2>
<p>In this example we will be looking at data on analysis of sediments and soils,
for which environmental guideline values exist in Australia. For sediments we
use the guidelines provided by Water Quality Australia (2024), which were
derived from the interim sediment quality guidelines (ISQG) (hence the name of
the file and data frame!). Soil guideline values are from NEPC (2013).</p>
<p>In the code chunk below we make use of the ability to name rows in R data
frames. This will be useful later on as we can include the row names in indices
to interrogate the data frame for the correct environmental threshold.</p>
<pre class="r"><code>ISQG &lt;- read.csv(&quot;https://github.com/Ratey-AtUWA/bookChapters/raw/main/ISQG.csv&quot;)
row.names(ISQG) &lt;- ISQG$Tox
HIL &lt;- read.csv(&quot;https://github.com/Ratey-AtUWA/bookChapters/raw/main/HIL_NEPM.csv&quot;)
row.names(HIL) &lt;- HIL$Tox</code></pre>
<pre class="r"><code>print(ISQG)
cat(&quot;\nNOTES:\nDGV = Default Guideline Value; GV_high = Upper Guideline Value; \n&quot;)
cat(&quot;Tox = Toxicant\n&quot;)</code></pre>
<pre><code>##       DGV GV_high Tox
## Ag   1.00       4  Ag
## As  20.00      70  As
## Cd   1.50      10  Cd
## Cr  80.00     370  Cr
## Cu  65.00     270  Cu
## Hg   0.15       1  Hg
## Pb  50.00     220  Pb
## Ni  21.00      52  Ni
## Sb   2.00      25  Sb
## Zn 200.00     410  Zn
## 
## NOTES:
## DGV = Default Guideline Value; GV_high = Upper Guideline Value; 
## Tox = Toxicant</code></pre>
<pre class="r"><code>print(HIL)</code></pre>
<pre><code>##                   Element   Tox Resid...A Resid...B Recreat...C Industr...D
## As                Arsenic    As       100       500         300        3000
## Be              Beryllium    Be        60        90          90         500
## B                   Boron     B      4500     40000       20000      300000
## Cd                Cadmium    Cd        20       150          90         900
## Cr           Chromium(VI)    Cr       100       500         300        3600
## Co                 Cobalt    Co       100       600         300        4000
## Cu                 Copper    Cu      6000     30000       17000      240000
## Pb                   Lead    Pb       300      1200         600        1500
## Mn              Manganese    Mn      3800     14000       19000       60000
## Hg    Mercury_(inorganic)    Hg        40       120          80         730
## CH3Hg      Methyl_mercury CH3Hg        10        30          13         180
## Ni                 Nickel    Ni       400      1200        1200        6000
## Se               Selenium    Se       200      1400         700       10000
## Zn                   Zinc    Zn      7400     60000       30000      400000
## CN         Cyanide_(free)    CN       250       300         240        1500
## 
## NOTES:
## Tox = Toxicant; Resid = Residential; 
## Recreat = Recreational / Public Open Space; Industr = Industrial</code></pre>
<p>We can see from the output above that, for reporting, it would be worthwhile
using a package (such as <code>flextable</code>, but there are several others) that can
produce more attractive and readable tables.</p>
</div>
<div id="importing-the-environmental-data-we-want-to-summarise" class="section level2">
<h2>Importing the environmental data we want to summarise</h2>
<p>We will use a subset of a dataset generated by some of our environmental science
classes at The University of Western Australia (see Rate and McGrath, 2022 for
an earlier version).</p>
<pre class="r"><code>git &lt;- &quot;https://github.com/Ratey-AtUWA/bookChapters/raw/main/&quot;
sedsoil &lt;- read.csv(paste0(git,&quot;afs1923abridged.csv&quot;), stringsAsFactors = TRUE)
# convert Year to a factor, and SampID to character
sedsoil$Year &lt;- factor(sedsoil$Year)
sedsoil$SampID &lt;- as.character(sedsoil$SampID)
summary(sedsoil)</code></pre>
<pre><code>##    Year       SampID                 Type       DepthType     Longitude    
##  2019:91   Length:336         Drain_Sed: 61   Core   : 47   Min.   :115.9  
##  2020:75   Class :character   Lake_Sed :121   Surface:289   1st Qu.:115.9  
##  2021:65   Mode  :character   Other    : 15                 Median :115.9  
##  2022:31                      Saltmarsh:139                 Mean   :115.9  
##  2023:74                                                    3rd Qu.:115.9  
##                                                             Max.   :115.9  
##                                                                            
##     Latitude            As               Cr              Cu        
##  Min.   :-31.92   Min.   : 0.400   Min.   : 1.00   Min.   :   2.0  
##  1st Qu.:-31.92   1st Qu.: 4.000   1st Qu.:34.00   1st Qu.:  32.0  
##  Median :-31.92   Median : 6.050   Median :54.70   Median :  61.0  
##  Mean   :-31.92   Mean   : 8.159   Mean   :49.33   Mean   : 111.7  
##  3rd Qu.:-31.92   3rd Qu.: 9.000   3rd Qu.:65.45   3rd Qu.: 165.5  
##  Max.   :-31.92   Max.   :62.000   Max.   :84.00   Max.   :1007.8  
##                   NA&#39;s   :13                       NA&#39;s   :9       
##        Mn               Ni              Pb               Zn        
##  Min.   :   6.0   Min.   : 1.00   Min.   :  1.00   Min.   :   1.0  
##  1st Qu.:  55.7   1st Qu.:13.00   1st Qu.: 25.73   1st Qu.: 108.2  
##  Median :  79.0   Median :19.00   Median : 37.30   Median : 222.5  
##  Mean   : 143.6   Mean   :19.05   Mean   : 54.91   Mean   : 471.5  
##  3rd Qu.: 120.5   3rd Qu.:24.80   3rd Qu.: 52.00   3rd Qu.: 359.5  
##  Max.   :3503.0   Max.   :50.00   Max.   :831.10   Max.   :7556.4  
##                   NA&#39;s   :9                        NA&#39;s   :4</code></pre>
<pre class="r"><code># first define the variables we want to summarise, and make the basic summary
elem0 &lt;- c(&quot;As&quot;,&quot;Cr&quot;,&quot;Cu&quot;,&quot;Mn&quot;,&quot;Ni&quot;,&quot;Pb&quot;,&quot;Zn&quot;)
(summ0 &lt;- numSummary(sedsoil[,elem0], 
                    statistics = c(&quot;mean&quot;,&quot;sd&quot;,&quot;quantiles&quot;),
                    quantiles = c(0,0.5,1)))</code></pre>
<pre><code>##          mean          sd  0%    50%   100%   n NA
## As   8.158529    7.712881 0.4   6.05   62.0 323 13
## Cr  49.332589   20.581402 1.0  54.70   84.0 336  0
## Cu 111.716208  121.118755 2.0  61.00 1007.8 327  9
## Mn 143.608036  309.044956 6.0  79.00 3503.0 336  0
## Ni  19.049388    7.998509 1.0  19.00   50.0 327  9
## Pb  54.906101   84.550788 1.0  37.30  831.1 336  0
## Zn 471.488554 1016.997243 1.0 222.50 7556.4 332  4</code></pre>
<p>At this stage it’s worth inspecting the contents of the list object created
using <code>numSummary()</code>:</p>
<pre class="r"><code>str(summ0)</code></pre>
<pre><code>## List of 5
##  $ type      : num 3
##  $ table     : num [1:7, 1:5] 8.16 49.33 111.72 143.61 19.05 ...
##   ..- attr(*, &quot;dimnames&quot;)=List of 2
##   .. ..$ : chr [1:7] &quot;As&quot; &quot;Cr&quot; &quot;Cu&quot; &quot;Mn&quot; ...
##   .. ..$ : chr [1:5] &quot;mean&quot; &quot;sd&quot; &quot;0%&quot; &quot;50%&quot; ...
##  $ statistics: chr [1:3] &quot;mean&quot; &quot;sd&quot; &quot;quantiles&quot;
##  $ n         : Named num [1:7] 323 336 327 336 327 336 332
##   ..- attr(*, &quot;names&quot;)= chr [1:7] &quot;As&quot; &quot;Cr&quot; &quot;Cu&quot; &quot;Mn&quot; ...
##  $ NAs       : Named num [1:7] 13 0 9 0 9 0 4
##   ..- attr(*, &quot;names&quot;)= chr [1:7] &quot;As&quot; &quot;Cr&quot; &quot;Cu&quot; &quot;Mn&quot; ...
##  - attr(*, &quot;class&quot;)= chr &quot;numSummary&quot;</code></pre>
<p>We can see that the main summary table (<code>$table</code>), the count of observations
(<code>$n</code>), and the count of missing values (<code>$NAs</code>) are stored as separate items in
the list. We will make use of this in the code below; we make a new data frame
to hold the results, since this is what we need to input into <code>flextable</code>.</p>
<p>To perform the actual counting of sample numbers, we use base R’s <code>which()</code>
function and the customised column and row names we generated earlier, <em>e.g</em>.,
<code>which(sedsoil[,elem0[i]] &gt; ISQG[elem0[i],"DGV"])</code>.</p>
<ul>
<li>The code <code>sedsoil[,elem0[i]]</code> selects the column from <code>sedsoil</code> with the same name as the i<sup>th</sup> element of the list of variables <code>elem0</code>, <em>i.e</em>. <code>elem0[i]</code>.<br />
</li>
<li>The code <code>ISQG[elem0[i],"DGV"]</code> find the desired value from the ISQG table using the row index <code>elem0[i]</code>, and the column index <code>"DGV"</code>. So, the variable names in the data must match the toxicant names in the thresholds table!!</li>
<li>So, <code>which(sedsoil[,elem0[i]] &gt; ISQG[elem0[i],"DGV"])</code> will give the row indices in <code>sedsoil</code> for which the condition is <code>TRUE</code>, and the code then simply counts these using <code>length(which(sedsoil[,elem0[i]] &gt; ISQG[elem0[i],"DGV"]))</code></li>
</ul>
<pre class="r"><code># just in case our variables have no NA values, make different ways
# of creating the data frame to hold our results

if(length(summ0$NAs)==0){
  OutputDF &lt;- data.frame(summ0$table,n=summ0$n,NAs=rep(0,length(summ0$n)))
} else {
  OutputDF &lt;- data.frame(summ0$table,n=summ0$n,NAs=summ0$NAs)
}

# add blank columns in data frame for environmental thresholds

OutputDF$DGV &lt;- rep(NA,length(elem0))
OutputDF$GV_high &lt;- rep(NA,length(elem0))
OutputDF$HIL_C &lt;- rep(NA,length(elem0))

# count the values for each element exceeding the various thresholds
# and populate the data frame

for(i in 1:length(elem0)){
  OutputDF$DGV[i] &lt;- 
    length(which(sedsoil[,elem0[i]] &gt; ISQG[elem0[i],&quot;DGV&quot;]))
  OutputDF$GV_high[i] &lt;- 
    length(which(sedsoil[,elem0[i]] &gt; ISQG[elem0[i],&quot;GV_high&quot;]))
  OutputDF$HIL_C[i] &lt;- 
    length(which(sedsoil[,elem0[i]] &gt; HIL[elem0[i],&quot;Recreational_C&quot;]))
}

# rename the columns to more understandable names

colnames(OutputDF)[c(3:5,8:10)] &lt;- c(&quot;min&quot;,&quot;median&quot;,&quot;max&quot;,&quot;n &gt; DGV&quot;,&quot;n &gt; GV-high&quot;, &quot;n &gt; HIL(C)&quot;)
print(OutputDF)</code></pre>
<pre><code>##          mean          sd min median    max   n NAs n &gt; DGV n &gt; GV-high
## As   8.158529    7.712881 0.4   6.05   62.0 323  13      26           0
## Cr  49.332589   20.581402 1.0  54.70   84.0 336   0       6           0
## Cu 111.716208  121.118755 2.0  61.00 1007.8 327   9     156          26
## Mn 143.608036  309.044956 6.0  79.00 3503.0 336   0       0           0
## Ni  19.049388    7.998509 1.0  19.00   50.0 327   9     137           0
## Pb  54.906101   84.550788 1.0  37.30  831.1 336   0      91           9
## Zn 471.488554 1016.997243 1.0 222.50 7556.4 332   4     185          73
##    n &gt; HIL(C)
## As          0
## Cr          0
## Cu          0
## Mn          0
## Ni          0
## Pb          4
## Zn          0</code></pre>
<p>We could stop here, but this is not an attractively-formatted table. To make a
publication-quality table, we first make a new data frame with columns and rows
transposed (using <code>t()</code>), with the previous column names as the first column.</p>
<p>To avoid lots of nesting of <code>flextable</code> functions, we find it easiest to pipe
the successive lines of code containing formatting modifications. We use the
[new] native R pipe operator <code>|&gt;</code> here, but the older <code>magrittr</code> pipe operator
<code>%&gt;%</code> would work if you prefer. Where we need the <code>officer</code> package is to
interpret the formatting option <code>fp_p=fp_par(text.align = "left", padding.bottom = 6)</code>
in the <code>set_caption()</code> function.</p>
<pre class="r"><code># make a new data frame with columns and rows transposed, and the 
# previous column names as the first column:
ft &lt;- as.data.frame(cbind(colnames(OutputDF),t(signif(OutputDF,3))))

# Then, use flextable to output a table in publication-quality form

flextable(ft) |&gt;
  width(j=c(1:7), width=c(3,rep(2.2,6)), unit=&quot;cm&quot;) |&gt;
  set_header_labels(values=list(V1=&quot;&quot;)) |&gt;
  align(j=2:8, align=&quot;right&quot;, part=&quot;all&quot;) |&gt;
  padding(i=8, padding.top = 8) |&gt;
  bold(bold=TRUE, part=&quot;header&quot;) |&gt;
  set_caption(caption=&quot;Summary statistics for trace element concentrations (mg/kg) in sediment or soil at Ashfield Flats. Abbreviations: n = number of valid observations; NAs = number of missing observations; n &gt; DGV is number of samples exceeding the sediment Default Guideline Value; n &gt; GV-high is number of samples exceeding the sediment upper Guideline Value at which toxicity effects might be expected (Water Quality Australia, 2024). HIL(C) is the human-health based investigation level for Recreational (public open space) land use (NEPC, 2013).&quot;, align_with_table=F, fp_p=fp_par(text.align = &quot;left&quot;, padding.bottom = 6))</code></pre>
<template id="2ac0289f-313a-45ad-a8bd-7c59ed7a9682"><style>
.tabwid table{
  border-spacing:0px !important;
  border-collapse:collapse;
  line-height:1;
  margin-left:auto;
  margin-right:auto;
  border-width: 0;
  display: table;
  border-color: transparent;
  caption-side: top;
}
.tabwid-caption-bottom table{
  caption-side: bottom;
}
.tabwid_left table{
  margin-left:0;
}
.tabwid_right table{
  margin-right:0;
}
.tabwid td {
    padding: 0;
}
.tabwid a {
  text-decoration: none;
}
.tabwid thead {
    background-color: transparent;
}
.tabwid tfoot {
    background-color: transparent;
}
.tabwid table tr {
background-color: transparent;
}
.katex-display {
    margin: 0 0 !important;
}
</style><div class="tabwid"><style>.cl-986ac51a{}.cl-98604a0e{font-family:'Arial';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-98604a22{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-986465ee{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:1pt;padding-top:1pt;padding-left:1pt;padding-right:1pt;line-height: 1;background-color:transparent;}.cl-9864660c{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:1pt;padding-top:1pt;padding-left:1pt;padding-right:1pt;line-height: 1;background-color:transparent;}.cl-98646616{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:1pt;padding-top:8pt;padding-left:1pt;padding-right:1pt;line-height: 1;background-color:transparent;}.cl-98646620{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:1pt;padding-top:8pt;padding-left:1pt;padding-right:1pt;line-height: 1;background-color:transparent;}.cl-98648146{width:1.181in;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 2pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-98648150{width:0.866in;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 2pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9864815a{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 2pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9864815b{width:1.181in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-98648164{width:0.866in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-98648165{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9864816e{width:1.181in;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9864816f{width:0.866in;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-98648178{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9859fde8{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}</style><table class='cl-986ac51a'>

<caption style="margin:0pt;text-align:left;border-bottom: 0.00pt solid transparent;border-top: 0.00pt solid transparent;border-left: 0.00pt solid transparent;border-right: 0.00pt solid transparent;padding-top:0pt;padding-bottom:6pt;padding-left:0pt;padding-right:0pt;line-height: 1;background-color:transparent;">
<span id="tab:unnamed-chunk-10">Table 1: </span><span class="cl-9859fde8">Summary statistics for trace element concentrations (mg/kg) in sediment or soil at Ashfield Flats. Abbreviations: n = number of valid observations; NAs = number of missing observations; n &gt; DGV is number of samples exceeding the sediment Default Guideline Value; n &gt; GV-high is number of samples exceeding the sediment upper Guideline Value at which toxicity effects might be expected (Water Quality Australia, 2024). HIL(C) is the human-health based investigation level for Recreational (public open space) land use (NEPC, 2013).</span>
</caption>

<thead><tr style="overflow-wrap:break-word;"><td class="cl-98648146"><p class="cl-986465ee"><span class="cl-98604a0e"></span></p></td><td class="cl-98648150"><p class="cl-9864660c"><span class="cl-98604a0e">As</span></p></td><td class="cl-98648150"><p class="cl-9864660c"><span class="cl-98604a0e">Cr</span></p></td><td class="cl-98648150"><p class="cl-9864660c"><span class="cl-98604a0e">Cu</span></p></td><td class="cl-98648150"><p class="cl-9864660c"><span class="cl-98604a0e">Mn</span></p></td><td class="cl-98648150"><p class="cl-9864660c"><span class="cl-98604a0e">Ni</span></p></td><td class="cl-98648150"><p class="cl-9864660c"><span class="cl-98604a0e">Pb</span></p></td><td class="cl-9864815a"><p class="cl-9864660c"><span class="cl-98604a0e">Zn</span></p></td></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-9864815b"><p class="cl-986465ee"><span class="cl-98604a22">mean</span></p></td><td class="cl-98648164"><p class="cl-9864660c"><span class="cl-98604a22">8.16</span></p></td><td class="cl-98648164"><p class="cl-9864660c"><span class="cl-98604a22">49.3</span></p></td><td class="cl-98648164"><p class="cl-9864660c"><span class="cl-98604a22">112</span></p></td><td class="cl-98648164"><p class="cl-9864660c"><span class="cl-98604a22">144</span></p></td><td class="cl-98648164"><p class="cl-9864660c"><span class="cl-98604a22">19</span></p></td><td class="cl-98648164"><p class="cl-9864660c"><span class="cl-98604a22">54.9</span></p></td><td class="cl-98648165"><p class="cl-9864660c"><span class="cl-98604a22">471</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-9864815b"><p class="cl-986465ee"><span class="cl-98604a22">sd</span></p></td><td class="cl-98648164"><p class="cl-9864660c"><span class="cl-98604a22">7.71</span></p></td><td class="cl-98648164"><p class="cl-9864660c"><span class="cl-98604a22">20.6</span></p></td><td class="cl-98648164"><p class="cl-9864660c"><span class="cl-98604a22">121</span></p></td><td class="cl-98648164"><p class="cl-9864660c"><span class="cl-98604a22">309</span></p></td><td class="cl-98648164"><p class="cl-9864660c"><span class="cl-98604a22">8</span></p></td><td class="cl-98648164"><p class="cl-9864660c"><span class="cl-98604a22">84.6</span></p></td><td class="cl-98648165"><p class="cl-9864660c"><span class="cl-98604a22">1020</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-9864815b"><p class="cl-986465ee"><span class="cl-98604a22">min</span></p></td><td class="cl-98648164"><p class="cl-9864660c"><span class="cl-98604a22">0.4</span></p></td><td class="cl-98648164"><p class="cl-9864660c"><span class="cl-98604a22">1</span></p></td><td class="cl-98648164"><p class="cl-9864660c"><span class="cl-98604a22">2</span></p></td><td class="cl-98648164"><p class="cl-9864660c"><span class="cl-98604a22">6</span></p></td><td class="cl-98648164"><p class="cl-9864660c"><span class="cl-98604a22">1</span></p></td><td class="cl-98648164"><p class="cl-9864660c"><span class="cl-98604a22">1</span></p></td><td class="cl-98648165"><p class="cl-9864660c"><span class="cl-98604a22">1</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-9864815b"><p class="cl-986465ee"><span class="cl-98604a22">median</span></p></td><td class="cl-98648164"><p class="cl-9864660c"><span class="cl-98604a22">6.05</span></p></td><td class="cl-98648164"><p class="cl-9864660c"><span class="cl-98604a22">54.7</span></p></td><td class="cl-98648164"><p class="cl-9864660c"><span class="cl-98604a22">61</span></p></td><td class="cl-98648164"><p class="cl-9864660c"><span class="cl-98604a22">79</span></p></td><td class="cl-98648164"><p class="cl-9864660c"><span class="cl-98604a22">19</span></p></td><td class="cl-98648164"><p class="cl-9864660c"><span class="cl-98604a22">37.3</span></p></td><td class="cl-98648165"><p class="cl-9864660c"><span class="cl-98604a22">222</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-9864815b"><p class="cl-986465ee"><span class="cl-98604a22">max</span></p></td><td class="cl-98648164"><p class="cl-9864660c"><span class="cl-98604a22">62</span></p></td><td class="cl-98648164"><p class="cl-9864660c"><span class="cl-98604a22">84</span></p></td><td class="cl-98648164"><p class="cl-9864660c"><span class="cl-98604a22">1010</span></p></td><td class="cl-98648164"><p class="cl-9864660c"><span class="cl-98604a22">3500</span></p></td><td class="cl-98648164"><p class="cl-9864660c"><span class="cl-98604a22">50</span></p></td><td class="cl-98648164"><p class="cl-9864660c"><span class="cl-98604a22">831</span></p></td><td class="cl-98648165"><p class="cl-9864660c"><span class="cl-98604a22">7560</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-9864815b"><p class="cl-986465ee"><span class="cl-98604a22">n</span></p></td><td class="cl-98648164"><p class="cl-9864660c"><span class="cl-98604a22">323</span></p></td><td class="cl-98648164"><p class="cl-9864660c"><span class="cl-98604a22">336</span></p></td><td class="cl-98648164"><p class="cl-9864660c"><span class="cl-98604a22">327</span></p></td><td class="cl-98648164"><p class="cl-9864660c"><span class="cl-98604a22">336</span></p></td><td class="cl-98648164"><p class="cl-9864660c"><span class="cl-98604a22">327</span></p></td><td class="cl-98648164"><p class="cl-9864660c"><span class="cl-98604a22">336</span></p></td><td class="cl-98648165"><p class="cl-9864660c"><span class="cl-98604a22">332</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-9864815b"><p class="cl-986465ee"><span class="cl-98604a22">NAs</span></p></td><td class="cl-98648164"><p class="cl-9864660c"><span class="cl-98604a22">13</span></p></td><td class="cl-98648164"><p class="cl-9864660c"><span class="cl-98604a22">0</span></p></td><td class="cl-98648164"><p class="cl-9864660c"><span class="cl-98604a22">9</span></p></td><td class="cl-98648164"><p class="cl-9864660c"><span class="cl-98604a22">0</span></p></td><td class="cl-98648164"><p class="cl-9864660c"><span class="cl-98604a22">9</span></p></td><td class="cl-98648164"><p class="cl-9864660c"><span class="cl-98604a22">0</span></p></td><td class="cl-98648165"><p class="cl-9864660c"><span class="cl-98604a22">4</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-9864815b"><p class="cl-98646616"><span class="cl-98604a22">n &gt; DGV</span></p></td><td class="cl-98648164"><p class="cl-98646620"><span class="cl-98604a22">26</span></p></td><td class="cl-98648164"><p class="cl-98646620"><span class="cl-98604a22">6</span></p></td><td class="cl-98648164"><p class="cl-98646620"><span class="cl-98604a22">156</span></p></td><td class="cl-98648164"><p class="cl-98646620"><span class="cl-98604a22">0</span></p></td><td class="cl-98648164"><p class="cl-98646620"><span class="cl-98604a22">137</span></p></td><td class="cl-98648164"><p class="cl-98646620"><span class="cl-98604a22">91</span></p></td><td class="cl-98648165"><p class="cl-98646620"><span class="cl-98604a22">185</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-9864815b"><p class="cl-986465ee"><span class="cl-98604a22">n &gt; GV-high</span></p></td><td class="cl-98648164"><p class="cl-9864660c"><span class="cl-98604a22">0</span></p></td><td class="cl-98648164"><p class="cl-9864660c"><span class="cl-98604a22">0</span></p></td><td class="cl-98648164"><p class="cl-9864660c"><span class="cl-98604a22">26</span></p></td><td class="cl-98648164"><p class="cl-9864660c"><span class="cl-98604a22">0</span></p></td><td class="cl-98648164"><p class="cl-9864660c"><span class="cl-98604a22">0</span></p></td><td class="cl-98648164"><p class="cl-9864660c"><span class="cl-98604a22">9</span></p></td><td class="cl-98648165"><p class="cl-9864660c"><span class="cl-98604a22">73</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-9864816e"><p class="cl-986465ee"><span class="cl-98604a22">n &gt; HIL(C)</span></p></td><td class="cl-9864816f"><p class="cl-9864660c"><span class="cl-98604a22">0</span></p></td><td class="cl-9864816f"><p class="cl-9864660c"><span class="cl-98604a22">0</span></p></td><td class="cl-9864816f"><p class="cl-9864660c"><span class="cl-98604a22">0</span></p></td><td class="cl-9864816f"><p class="cl-9864660c"><span class="cl-98604a22">0</span></p></td><td class="cl-9864816f"><p class="cl-9864660c"><span class="cl-98604a22">0</span></p></td><td class="cl-9864816f"><p class="cl-9864660c"><span class="cl-98604a22">4</span></p></td><td class="cl-98648178"><p class="cl-9864660c"><span class="cl-98604a22">0</span></p></td></tr></tbody></table></div></template>
<div class="flextable-shadow-host" id="11a29e3f-de96-4c4d-9843-2b3bc960d23e"></div>
<script>
var dest = document.getElementById("11a29e3f-de96-4c4d-9843-2b3bc960d23e");
var template = document.getElementById("2ac0289f-313a-45ad-a8bd-7c59ed7a9682");
var caption = template.content.querySelector("caption");
var fantome = dest.attachShadow({mode: 'open'});
var templateContent = template.content;
fantome.appendChild(templateContent);
</script>

<p>
 
</p>
<p>The final table could now go into a report, and most readers would be happy with
its appearance. We could probably do something about the alignment of the
numeric columns, but decimal point alignment is not available in <code>flextable</code> yet.</p>
<p>The next really useful type of information to obtain would be <strong>where</strong> the samples
which exceed environmental thresholds are. That question leads us to another
more basic question: “<em>How can we map our data in R</em>,” and so further
chapters will cover preparing maps in R, and from there we can move on to spatial
analysis.</p>
</div>
<div id="references" class="section level2">
<h2>References</h2>
<p>NEPC (National Environment Protection Council). (2013). Schedule B(1): Guideline on the Investigation Levels for Soil and Groundwater. <strong>In</strong> <em>National Environment Protection (Assessment of Site Contamination) Measure (Amended)</em>. Commonwealth of Australia.</p>
<p>Rate, A. W., &amp; McGrath, G. S. (2022). Data for assessment of sediment, soil, and water quality at Ashfield Flats Reserve, Western Australia. <em>Data in Brief</em>, <strong>41</strong>, 107970. <a href="https://doi.org/10.1016/j.dib.2022.107970" target="_blank">https://doi.org/10.1016/j.dib.2022.107970</a></p>
<p>Water Quality Australia. (2024). <em>Toxicant default guideline values for sediment quality.</em> Department of Climate Change, Energy, the Environment and Water, Government of Australia. Retrieved 2024-04-11 from <a href="https://www.waterquality.gov.au/anz-guidelines/guideline-values/default/sediment-quality-toxicants" target="_blank">https://www.waterquality.gov.au/anz-guidelines/guideline-values/default/sediment-quality-toxicants</a></p>
<p>
 
</p>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
