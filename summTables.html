<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Andrew Rate" />

<meta name="date" content="2024-05-11" />

<title>Counting samples with R</title>

<script src="site_libs/header-attrs-2.17/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
<link href="site_libs/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-5.1.3/bootstrap.bundle.min.js"></script>
<script src="site_libs/bs3compat-0.4.0/transition.js"></script>
<script src="site_libs/bs3compat-0.4.0/tabs.js"></script>
<script src="site_libs/bs3compat-0.4.0/bs3compat.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/tabwid-1.1.0/tabwid.css" rel="stylesheet" />
<link href="site_libs/tabwid-1.1.0/scrool.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    background-color: #ffffff;
    color: #a0a0a0;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #a0a0a0;  padding-left: 4px; }
div.sourceCode
  { color: #1f1c1b; background-color: #ffffff; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span { color: #1f1c1b; } /* Normal */
code span.al { color: #bf0303; background-color: #f7e6e6; font-weight: bold; } /* Alert */
code span.an { color: #ca60ca; } /* Annotation */
code span.at { color: #0057ae; } /* Attribute */
code span.bn { color: #b08000; } /* BaseN */
code span.bu { color: #644a9b; font-weight: bold; } /* BuiltIn */
code span.cf { color: #1f1c1b; font-weight: bold; } /* ControlFlow */
code span.ch { color: #924c9d; } /* Char */
code span.cn { color: #aa5500; } /* Constant */
code span.co { color: #898887; } /* Comment */
code span.cv { color: #0095ff; } /* CommentVar */
code span.do { color: #607880; } /* Documentation */
code span.dt { color: #0057ae; } /* DataType */
code span.dv { color: #b08000; } /* DecVal */
code span.er { color: #bf0303; text-decoration: underline; } /* Error */
code span.ex { color: #0095ff; font-weight: bold; } /* Extension */
code span.fl { color: #b08000; } /* Float */
code span.fu { color: #644a9b; } /* Function */
code span.im { color: #ff5500; } /* Import */
code span.in { color: #b08000; } /* Information */
code span.kw { color: #1f1c1b; font-weight: bold; } /* Keyword */
code span.op { color: #1f1c1b; } /* Operator */
code span.ot { color: #006e28; } /* Other */
code span.pp { color: #006e28; } /* Preprocessor */
code span.re { color: #0057ae; background-color: #e0e9f8; } /* RegionMarker */
code span.sc { color: #3daee9; } /* SpecialChar */
code span.ss { color: #ff5500; } /* SpecialString */
code span.st { color: #bf0303; } /* String */
code span.va { color: #0057ae; } /* Variable */
code span.vs { color: #bf0303; } /* VerbatimString */
code span.wa { color: #bf0303; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>







<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-inverse  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">cyboRg</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fa fa-home"></span>
     
    Home
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fa fa-project-diagram"></span>
     
    Code
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="code.html">
        <span class="fa fa-arrow-circle-right"></span>
         
        All the code in one place
      </a>
    </li>
    <li>
      <a href="mapscode.html">
        <span class="fa fa-arrow-circle-right"></span>
         
        Maps and geostatistics
      </a>
    </li>
    <li>
      <a href="EDAcode.html">
        <span class="fa fa-arrow-circle-right"></span>
         
        Exploratory Data Analysis
      </a>
    </li>
    <li>
      <a href="CoDAcode.html">
        <span class="fa fa-arrow-circle-right"></span>
         
        Compositional Data Analysis
      </a>
    </li>
    <li>
      <a href="soilcode.html">
        <span class="fa fa-arrow-circle-right"></span>
         
        Soil science
      </a>
    </li>
    <li>
      <a href="filecode.html">
        <span class="fa fa-arrow-circle-right"></span>
         
        File conversions
      </a>
    </li>
    <li>
      <a href="biolcode.html">
        <span class="fa fa-arrow-circle-right"></span>
         
        Environmental Biology
      </a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fa fa-chalkboard-teacher"></span>
     
    Teaching
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="teaching.html">
        <span class="fa fa-arrow-circle-right"></span>
         
        All in one place
      </a>
    </li>
    <li>
      <a href="WhatsR.html">
        <span class="fa fa-arrow-circle-right"></span>
         
        Very basic R
      </a>
    </li>
    <li>
      <a href="Rbasics.html">
        <span class="fa fa-arrow-circle-right"></span>
         
        Intro to R
      </a>
    </li>
    <li>
      <a href="Rgraphs.html">
        <span class="fa fa-arrow-circle-right"></span>
         
        Intro to R graphics
      </a>
    </li>
    <li>
      <a href="transformR.html">
        <span class="fa fa-arrow-circle-right"></span>
         
        Variable distributions
      </a>
    </li>
    <li>
      <a href="meansR.html">
        <span class="fa fa-arrow-circle-right"></span>
         
        Comparing means
      </a>
    </li>
    <li>
      <a href="relationR.html">
        <span class="fa fa-arrow-circle-right"></span>
         
        Relationships
      </a>
    </li>
    <li>
      <a href="Rmaps.html">
        <span class="fa fa-arrow-circle-right"></span>
         
        Basic maps in R
      </a>
    </li>
    <li>
      <a href="geostats.html">
        <span class="fa fa-arrow-circle-right"></span>
         
        Geostatistics
      </a>
    </li>
    <li>
      <a href="vegan.html">
        <span class="fa fa-arrow-circle-right"></span>
         
        Multivariate eDNA
      </a>
    </li>
    <li>
      <a href="timeseries.html">
        <span class="fa fa-arrow-circle-right"></span>
         
        Time series
      </a>
    </li>
    <li>
      <a href="compositional_Pt0-Intro.html">
        <span class="fa fa-arrow-circle-right"></span>
         
        Compositional data analysis Intro
      </a>
    </li>
    <li>
      <a href="compositional_Pt1-PCA.html">
        <span class="fa fa-arrow-circle-right"></span>
         
        PCA for compositional data analysis
      </a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fa fa-bell"></span>
     
    Rants
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="rants.html">
        <span class="fa fa-comment-dots"></span>
         
        All the rants in one place
      </a>
    </li>
    <li>
      <a href="profmetal.html">
        <span class="fa fa-comment-dots"></span>
         
        profundus metallum
      </a>
    </li>
  </ul>
</li>
<li>
  <a href="images.html">
    <span class="fa fa-images"></span>
     
    Images
  </a>
</li>
<li>
  <a href="about.html">
    <span class="fa fa-address-card"></span>
     
    About
  </a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="social.html">
    <span class="fa fa-twitter"></span>
     
    Social
  </a>
</li>
<li>
  <a href="work.html">
    <span class="fa fa-user-graduate"></span>
     
    UWA
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Counting samples with R</h1>
<h4 class="author">Andrew Rate</h4>
<h4 class="date">2024-05-11</h4>

</div>


<div
id="summary-statistics-tables-which-include-sample-counts-above-environmental-thresholds"
class="section level2">
<h2>Summary statistics tables which include sample counts above
environmental thresholds</h2>
<p>Load the R packages we need and set a default table style
(‘<code>theme</code>’):</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(RcmdrMisc)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="fu">library</span>(flextable)</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>  <span class="fu">set_flextable_defaults</span>(<span class="at">font.family =</span> <span class="st">&quot;Arial&quot;</span>, <span class="at">font.size =</span> <span class="dv">11</span>, </span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a>                       <span class="at">theme_fun =</span> <span class="st">&quot;theme_booktabs&quot;</span>, <span class="at">padding =</span> <span class="dv">1</span>)</span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a><span class="fu">library</span>(officer)</span></code></pre></div>
</div>
<div id="introduction" class="section level2">
<h2>Introduction</h2>
<p>In environmental reporting it's common to produce tables containing
statistical summaries of the variables which have been measured at a
particular location or in a specific environment. The statistical
parameters presented often include basic statistics such as mean,
median, standard deviation, minimum, and maximum. In many environmental
contexts (<em>e.g</em>. assessing environments for pollution or
contamination) it's also very useful to know if any samples have
concentrations of contaminants that exceed environmental thresholds, and
if so, how many.</p>
<p>The first code chunk (above) shows that we will use the
<code>RcmdrMisc</code> package, as it contains the useful
<code>numSummary()</code> function, and the <code>flextable</code>
package for producing nicely-formatted tables. We also load the
<code>officer</code> package to make use of some formatting options in
<code>flextable</code>. The rest of the code just makes use of function
in base R.</p>
</div>
<div id="importing-environmental-threshold-data" class="section level2">
<h2>Importing environmental threshold data</h2>
<p>In this example we will be looking at data on analysis of sediments
and soils, for which environmental guideline values exist in Australia.
For sediments we use the guidelines provided by Water Quality Australia
(2024), which were derived from the interim sediment quality guidelines
(ISQG) (hence the name of the file and data frame!). Soil guideline
values are from NEPC (2013).</p>
<p>In the code chunk below we make use of the ability to name rows in R
data frames. This will be useful later on as we can include the row
names in indices to interrogate the data frame for the correct
environmental threshold.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a>ISQG <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;https://github.com/Ratey-AtUWA/bookChapters/raw/main/ISQG.csv&quot;</span>)</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="fu">row.names</span>(ISQG) <span class="ot">&lt;-</span> ISQG<span class="sc">$</span>Tox</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>HIL <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;https://github.com/Ratey-AtUWA/bookChapters/raw/main/HIL_NEPM.csv&quot;</span>)</span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a><span class="fu">row.names</span>(HIL) <span class="ot">&lt;-</span> HIL<span class="sc">$</span>Tox</span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="fu">print</span>(ISQG)</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">NOTES:</span><span class="sc">\n</span><span class="st">DGV = Default Guideline Value; GV_high = Upper Guideline Value; </span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Tox = Toxicant</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>##       DGV GV_high Tox
## Ag   1.00       4  Ag
## As  20.00      70  As
## Cd   1.50      10  Cd
## Cr  80.00     370  Cr
## Cu  65.00     270  Cu
## Hg   0.15       1  Hg
## Pb  50.00     220  Pb
## Ni  21.00      52  Ni
## Sb   2.00      25  Sb
## Zn 200.00     410  Zn
## 
## NOTES:
## DGV = Default Guideline Value; GV_high = Upper Guideline Value; 
## Tox = Toxicant</code></pre>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="fu">print</span>(HIL)</span></code></pre></div>
<pre><code>##                   Element   Tox Resid...A Resid...B Recreat...C Industr...D
## As                Arsenic    As       100       500         300        3000
## Be              Beryllium    Be        60        90          90         500
## B                   Boron     B      4500     40000       20000      300000
## Cd                Cadmium    Cd        20       150          90         900
## Cr           Chromium(VI)    Cr       100       500         300        3600
## Co                 Cobalt    Co       100       600         300        4000
## Cu                 Copper    Cu      6000     30000       17000      240000
## Pb                   Lead    Pb       300      1200         600        1500
## Mn              Manganese    Mn      3800     14000       19000       60000
## Hg    Mercury_(inorganic)    Hg        40       120          80         730
## CH3Hg      Methyl_mercury CH3Hg        10        30          13         180
## Ni                 Nickel    Ni       400      1200        1200        6000
## Se               Selenium    Se       200      1400         700       10000
## Zn                   Zinc    Zn      7400     60000       30000      400000
## CN         Cyanide_(free)    CN       250       300         240        1500
## 
## NOTES:
## Tox = Toxicant; Resid = Residential; 
## Recreat = Recreational / Public Open Space; Industr = Industrial</code></pre>
<p>We can see from the output above that, for reporting, it would be
worthwhile using a package (such as <code>flextable</code>, but there
are several others) that can produce more attractive and readable
tables.</p>
</div>
<div id="importing-the-environmental-data-we-want-to-summarise"
class="section level2">
<h2>Importing the environmental data we want to summarise</h2>
<p>We will use a subset of a dataset generated by some of our
environmental science classes at The University of Western Australia
(see Rate and McGrath, 2022 for an earlier version).</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a>git <span class="ot">&lt;-</span> <span class="st">&quot;https://github.com/Ratey-AtUWA/bookChapters/raw/main/&quot;</span></span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>sedsoil <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="fu">paste0</span>(git,<span class="st">&quot;afs1923abridged.csv&quot;</span>), <span class="at">stringsAsFactors =</span> <span class="cn">TRUE</span>)</span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a><span class="co"># convert Year to a factor, and SampID to character</span></span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a>sedsoil<span class="sc">$</span>Year <span class="ot">&lt;-</span> <span class="fu">factor</span>(sedsoil<span class="sc">$</span>Year)</span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a>sedsoil<span class="sc">$</span>SampID <span class="ot">&lt;-</span> <span class="fu">as.character</span>(sedsoil<span class="sc">$</span>SampID)</span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a><span class="fu">summary</span>(sedsoil)</span></code></pre></div>
<pre><code>##    Year       SampID                 Type       DepthType     Longitude        Latitude     
##  2019:91   Length:336         Drain_Sed: 61   Core   : 47   Min.   :115.9   Min.   :-31.92  
##  2020:75   Class :character   Lake_Sed :121   Surface:289   1st Qu.:115.9   1st Qu.:-31.92  
##  2021:65   Mode  :character   Other    : 15                 Median :115.9   Median :-31.92  
##  2022:31                      Saltmarsh:139                 Mean   :115.9   Mean   :-31.92  
##  2023:74                                                    3rd Qu.:115.9   3rd Qu.:-31.92  
##                                                             Max.   :115.9   Max.   :-31.92  
##                                                                                             
##        As               Cr              Cu               Mn               Ni       
##  Min.   : 0.400   Min.   : 1.00   Min.   :   2.0   Min.   :   6.0   Min.   : 1.00  
##  1st Qu.: 4.000   1st Qu.:34.00   1st Qu.:  32.0   1st Qu.:  55.7   1st Qu.:13.00  
##  Median : 6.050   Median :54.70   Median :  61.0   Median :  79.0   Median :19.00  
##  Mean   : 8.159   Mean   :49.33   Mean   : 111.7   Mean   : 143.6   Mean   :19.05  
##  3rd Qu.: 9.000   3rd Qu.:65.45   3rd Qu.: 165.5   3rd Qu.: 120.5   3rd Qu.:24.80  
##  Max.   :62.000   Max.   :84.00   Max.   :1007.8   Max.   :3503.0   Max.   :50.00  
##  NA&#39;s   :13                       NA&#39;s   :9                         NA&#39;s   :9      
##        Pb               Zn        
##  Min.   :  1.00   Min.   :   1.0  
##  1st Qu.: 25.73   1st Qu.: 108.2  
##  Median : 37.30   Median : 222.5  
##  Mean   : 54.91   Mean   : 471.5  
##  3rd Qu.: 52.00   3rd Qu.: 359.5  
##  Max.   :831.10   Max.   :7556.4  
##                   NA&#39;s   :4</code></pre>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="co"># first define the variables we want to summarise, and make the basic summary</span></span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>elem0 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;As&quot;</span>,<span class="st">&quot;Cr&quot;</span>,<span class="st">&quot;Cu&quot;</span>,<span class="st">&quot;Mn&quot;</span>,<span class="st">&quot;Ni&quot;</span>,<span class="st">&quot;Pb&quot;</span>,<span class="st">&quot;Zn&quot;</span>)</span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a>(summ0 <span class="ot">&lt;-</span> <span class="fu">numSummary</span>(sedsoil[,elem0], </span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a>                    <span class="at">statistics =</span> <span class="fu">c</span>(<span class="st">&quot;mean&quot;</span>,<span class="st">&quot;sd&quot;</span>,<span class="st">&quot;quantiles&quot;</span>),</span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a>                    <span class="at">quantiles =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.5</span>,<span class="dv">1</span>)))</span></code></pre></div>
<pre><code>##          mean          sd  0%    50%   100%   n NA
## As   8.158529    7.712881 0.4   6.05   62.0 323 13
## Cr  49.332589   20.581402 1.0  54.70   84.0 336  0
## Cu 111.716208  121.118755 2.0  61.00 1007.8 327  9
## Mn 143.608036  309.044956 6.0  79.00 3503.0 336  0
## Ni  19.049388    7.998509 1.0  19.00   50.0 327  9
## Pb  54.906101   84.550788 1.0  37.30  831.1 336  0
## Zn 471.488554 1016.997243 1.0 222.50 7556.4 332  4</code></pre>
<p>At this stage it's worth inspecting the contents of the list object
created using <code>numSummary()</code>:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="fu">str</span>(summ0)</span></code></pre></div>
<pre><code>## List of 5
##  $ type      : num 3
##  $ table     : num [1:7, 1:5] 8.16 49.33 111.72 143.61 19.05 ...
##   ..- attr(*, &quot;dimnames&quot;)=List of 2
##   .. ..$ : chr [1:7] &quot;As&quot; &quot;Cr&quot; &quot;Cu&quot; &quot;Mn&quot; ...
##   .. ..$ : chr [1:5] &quot;mean&quot; &quot;sd&quot; &quot;0%&quot; &quot;50%&quot; ...
##  $ statistics: chr [1:3] &quot;mean&quot; &quot;sd&quot; &quot;quantiles&quot;
##  $ n         : Named num [1:7] 323 336 327 336 327 336 332
##   ..- attr(*, &quot;names&quot;)= chr [1:7] &quot;As&quot; &quot;Cr&quot; &quot;Cu&quot; &quot;Mn&quot; ...
##  $ NAs       : Named num [1:7] 13 0 9 0 9 0 4
##   ..- attr(*, &quot;names&quot;)= chr [1:7] &quot;As&quot; &quot;Cr&quot; &quot;Cu&quot; &quot;Mn&quot; ...
##  - attr(*, &quot;class&quot;)= chr &quot;numSummary&quot;</code></pre>
<p>We can see that the main summary table (<code>$table</code>), the
count of observations (<code>$n</code>), and the count of missing values
(<code>$NAs</code>) are stored as separate items in the list. We will
make use of this in the code below; we make a new data frame to hold the
results, since this is what we need to input into
<code>flextable</code>.</p>
<p>To perform the actual counting of sample numbers, we use base R's
<code>which()</code> function and the customised column and row names we
generated earlier, <em>e.g</em>.,
<code>which(sedsoil[,elem0[i]] &gt; ISQG[elem0[i],"DGV"])</code>.</p>
<ul>
<li>The code <code>sedsoil[,elem0[i]]</code> selects the column from
<code>sedsoil</code> with the same name as the i<sup>th</sup> element of
the list of variables <code>elem0</code>, <em>i.e</em>.
<code>elem0[i]</code>.<br />
</li>
<li>The code <code>ISQG[elem0[i],"DGV"]</code> find the desired value
from the ISQG table using the row index <code>elem0[i]</code>, and the
column index <code>"DGV"</code>. So, the variable names in the data must
match the toxicant names in the thresholds table!!</li>
<li>So, <code>which(sedsoil[,elem0[i]] &gt; ISQG[elem0[i],"DGV"])</code>
will give the row indices in <code>sedsoil</code> for which the
condition is <code>TRUE</code>, and the code then simply counts these
using
<code>length(which(sedsoil[,elem0[i]] &gt; ISQG[elem0[i],"DGV"]))</code></li>
</ul>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="co"># just in case our variables have no NA values, make different ways</span></span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a><span class="co"># of creating the data frame to hold our results</span></span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">length</span>(summ0<span class="sc">$</span>NAs)<span class="sc">==</span><span class="dv">0</span>){</span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a>  OutputDF <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(summ0<span class="sc">$</span>table,<span class="at">n=</span>summ0<span class="sc">$</span>n,<span class="at">NAs=</span><span class="fu">rep</span>(<span class="dv">0</span>,<span class="fu">length</span>(summ0<span class="sc">$</span>n)))</span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb13-7"><a href="#cb13-7" tabindex="-1"></a>  OutputDF <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(summ0<span class="sc">$</span>table,<span class="at">n=</span>summ0<span class="sc">$</span>n,<span class="at">NAs=</span>summ0<span class="sc">$</span>NAs)</span>
<span id="cb13-8"><a href="#cb13-8" tabindex="-1"></a>}</span>
<span id="cb13-9"><a href="#cb13-9" tabindex="-1"></a></span>
<span id="cb13-10"><a href="#cb13-10" tabindex="-1"></a><span class="co"># add blank columns in data frame for environmental thresholds</span></span>
<span id="cb13-11"><a href="#cb13-11" tabindex="-1"></a></span>
<span id="cb13-12"><a href="#cb13-12" tabindex="-1"></a>OutputDF<span class="sc">$</span>DGV <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>,<span class="fu">length</span>(elem0))</span>
<span id="cb13-13"><a href="#cb13-13" tabindex="-1"></a>OutputDF<span class="sc">$</span>GV_high <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>,<span class="fu">length</span>(elem0))</span>
<span id="cb13-14"><a href="#cb13-14" tabindex="-1"></a>OutputDF<span class="sc">$</span>HIL_C <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>,<span class="fu">length</span>(elem0))</span>
<span id="cb13-15"><a href="#cb13-15" tabindex="-1"></a></span>
<span id="cb13-16"><a href="#cb13-16" tabindex="-1"></a><span class="co"># count the values for each element exceeding the various thresholds</span></span>
<span id="cb13-17"><a href="#cb13-17" tabindex="-1"></a><span class="co"># and populate the data frame</span></span>
<span id="cb13-18"><a href="#cb13-18" tabindex="-1"></a></span>
<span id="cb13-19"><a href="#cb13-19" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(elem0)){</span>
<span id="cb13-20"><a href="#cb13-20" tabindex="-1"></a>  OutputDF<span class="sc">$</span>DGV[i] <span class="ot">&lt;-</span> </span>
<span id="cb13-21"><a href="#cb13-21" tabindex="-1"></a>    <span class="fu">length</span>(<span class="fu">which</span>(sedsoil[,elem0[i]] <span class="sc">&gt;</span> ISQG[elem0[i],<span class="st">&quot;DGV&quot;</span>]))</span>
<span id="cb13-22"><a href="#cb13-22" tabindex="-1"></a>  OutputDF<span class="sc">$</span>GV_high[i] <span class="ot">&lt;-</span> </span>
<span id="cb13-23"><a href="#cb13-23" tabindex="-1"></a>    <span class="fu">length</span>(<span class="fu">which</span>(sedsoil[,elem0[i]] <span class="sc">&gt;</span> ISQG[elem0[i],<span class="st">&quot;GV_high&quot;</span>]))</span>
<span id="cb13-24"><a href="#cb13-24" tabindex="-1"></a>  OutputDF<span class="sc">$</span>HIL_C[i] <span class="ot">&lt;-</span> </span>
<span id="cb13-25"><a href="#cb13-25" tabindex="-1"></a>    <span class="fu">length</span>(<span class="fu">which</span>(sedsoil[,elem0[i]] <span class="sc">&gt;</span> HIL[elem0[i],<span class="st">&quot;Recreational_C&quot;</span>]))</span>
<span id="cb13-26"><a href="#cb13-26" tabindex="-1"></a>}</span>
<span id="cb13-27"><a href="#cb13-27" tabindex="-1"></a></span>
<span id="cb13-28"><a href="#cb13-28" tabindex="-1"></a><span class="co"># rename the columns to more understandable names</span></span>
<span id="cb13-29"><a href="#cb13-29" tabindex="-1"></a></span>
<span id="cb13-30"><a href="#cb13-30" tabindex="-1"></a><span class="fu">colnames</span>(OutputDF)[<span class="fu">c</span>(<span class="dv">3</span><span class="sc">:</span><span class="dv">5</span>,<span class="dv">8</span><span class="sc">:</span><span class="dv">10</span>)] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;min&quot;</span>,<span class="st">&quot;median&quot;</span>,<span class="st">&quot;max&quot;</span>,<span class="st">&quot;n &gt; DGV&quot;</span>,<span class="st">&quot;n &gt; GV-high&quot;</span>, <span class="st">&quot;n &gt; HIL(C)&quot;</span>)</span>
<span id="cb13-31"><a href="#cb13-31" tabindex="-1"></a><span class="fu">print</span>(OutputDF)</span></code></pre></div>
<pre><code>##          mean          sd min median    max   n NAs n &gt; DGV n &gt; GV-high n &gt; HIL(C)
## As   8.158529    7.712881 0.4   6.05   62.0 323  13      26           0          0
## Cr  49.332589   20.581402 1.0  54.70   84.0 336   0       6           0          0
## Cu 111.716208  121.118755 2.0  61.00 1007.8 327   9     156          26          0
## Mn 143.608036  309.044956 6.0  79.00 3503.0 336   0       0           0          0
## Ni  19.049388    7.998509 1.0  19.00   50.0 327   9     137           0          0
## Pb  54.906101   84.550788 1.0  37.30  831.1 336   0      91           9          4
## Zn 471.488554 1016.997243 1.0 222.50 7556.4 332   4     185          73          0</code></pre>
<p>We could stop here, but this is not an attractively-formatted table.
To make a publication-quality table, we first make a new data frame with
columns and rows transposed (using <code>t()</code>), with the previous
column names as the first column.</p>
<p>To avoid lots of nesting of <code>flextable</code> functions, we find
it easiest to pipe the successive lines of code containing formatting
modifications. We use the [new] native R pipe operator
<code>|&gt;</code> here, but the older <code>magrittr</code> pipe
operator <code>%&gt;%</code> would work if you prefer. Where we need the
<code>officer</code> package is to interpret the formatting option
<code>fp_p=fp_par(text.align = "left", padding.bottom = 6)</code> in the
<code>set_caption()</code> function.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="co"># make a new data frame with columns and rows transposed, and the </span></span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a><span class="co"># previous column names as the first column:</span></span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a>ft <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">cbind</span>(<span class="fu">colnames</span>(OutputDF),<span class="fu">t</span>(<span class="fu">signif</span>(OutputDF,<span class="dv">3</span>))))</span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a></span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a><span class="co"># Then, use flextable to output a table in publication-quality form</span></span>
<span id="cb15-6"><a href="#cb15-6" tabindex="-1"></a></span>
<span id="cb15-7"><a href="#cb15-7" tabindex="-1"></a><span class="fu">flextable</span>(ft) <span class="sc">|&gt;</span></span>
<span id="cb15-8"><a href="#cb15-8" tabindex="-1"></a>  <span class="fu">width</span>(<span class="at">j=</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>), <span class="at">width=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="fu">rep</span>(<span class="fl">2.2</span>,<span class="dv">6</span>)), <span class="at">unit=</span><span class="st">&quot;cm&quot;</span>) <span class="sc">|&gt;</span></span>
<span id="cb15-9"><a href="#cb15-9" tabindex="-1"></a>  <span class="fu">set_header_labels</span>(<span class="at">values=</span><span class="fu">list</span>(<span class="at">V1=</span><span class="st">&quot;&quot;</span>)) <span class="sc">|&gt;</span></span>
<span id="cb15-10"><a href="#cb15-10" tabindex="-1"></a>  <span class="fu">align</span>(<span class="at">j=</span><span class="dv">2</span><span class="sc">:</span><span class="dv">8</span>, <span class="at">align=</span><span class="st">&quot;right&quot;</span>, <span class="at">part=</span><span class="st">&quot;all&quot;</span>) <span class="sc">|&gt;</span></span>
<span id="cb15-11"><a href="#cb15-11" tabindex="-1"></a>  <span class="fu">padding</span>(<span class="at">i=</span><span class="dv">8</span>, <span class="at">padding.top =</span> <span class="dv">8</span>) <span class="sc">|&gt;</span></span>
<span id="cb15-12"><a href="#cb15-12" tabindex="-1"></a>  <span class="fu">bold</span>(<span class="at">bold=</span><span class="cn">TRUE</span>, <span class="at">part=</span><span class="st">&quot;header&quot;</span>) <span class="sc">|&gt;</span></span>
<span id="cb15-13"><a href="#cb15-13" tabindex="-1"></a>  <span class="fu">set_caption</span>(<span class="at">caption=</span><span class="st">&quot;Table 1: Summary statistics for trace element concentrations (mg/kg) in sediment or soil at Ashfield Flats. Abbreviations: n = number of valid observations; NAs = number of missing observations; n &gt; DGV is number of samples exceeding the sediment Default Guideline Value; n &gt; GV-high is number of samples exceeding the sediment upper Guideline Value at which toxicity effects might be expected (Water Quality Australia, 2024). HIL(C) is the human-health based investigation level for Recreational (public open space) land use (NEPC, 2013).&quot;</span>, <span class="at">align_with_table=</span>F, <span class="at">fp_p=</span><span class="fu">fp_par</span>(<span class="at">text.align =</span> <span class="st">&quot;left&quot;</span>, <span class="at">padding.bottom =</span> <span class="dv">6</span>))</span></code></pre></div>
<template id="d19066b6-7c5a-4288-a172-0dbdbc2e4f21"><style>
.tabwid table{
  border-spacing:0px !important;
  border-collapse:collapse;
  line-height:1;
  margin-left:auto;
  margin-right:auto;
  border-width: 0;
  display: table;
  border-color: transparent;
  caption-side: top;
}
.tabwid-caption-bottom table{
  caption-side: bottom;
}
.tabwid_left table{
  margin-left:0;
}
.tabwid_right table{
  margin-right:0;
}
.tabwid td {
    padding: 0;
}
.tabwid a {
  text-decoration: none;
}
.tabwid thead {
    background-color: transparent;
}
.tabwid tfoot {
    background-color: transparent;
}
.tabwid table tr {
background-color: transparent;
}
.katex-display {
    margin: 0 0 !important;
}
</style><div class="tabwid"><style>.cl-eaa0aebe{}.cl-ea975e04{font-family:'Arial';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-ea975e0e{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-ea9ad7c8{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:1pt;padding-top:1pt;padding-left:1pt;padding-right:1pt;line-height: 1;background-color:transparent;}.cl-ea9ad7d2{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:1pt;padding-top:1pt;padding-left:1pt;padding-right:1pt;line-height: 1;background-color:transparent;}.cl-ea9ad7d3{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:1pt;padding-top:8pt;padding-left:1pt;padding-right:1pt;line-height: 1;background-color:transparent;}.cl-ea9ad7dc{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:1pt;padding-top:8pt;padding-left:1pt;padding-right:1pt;line-height: 1;background-color:transparent;}.cl-ea9aed9e{width:1.181in;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 2pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ea9aeda8{width:0.866in;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 2pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ea9aeda9{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 2pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ea9aedaa{width:1.181in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ea9aedb2{width:0.866in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ea9aedb3{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ea9aedbc{width:1.181in;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ea9aedbd{width:0.866in;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ea9aedbe{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ea91c976{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}</style><table class='cl-eaa0aebe'><caption style="margin:0pt;text-align:left;border-bottom: 0.00pt solid transparent;border-top: 0.00pt solid transparent;border-left: 0.00pt solid transparent;border-right: 0.00pt solid transparent;padding-top:0pt;padding-bottom:6pt;padding-left:0pt;padding-right:0pt;line-height: 1;background-color:transparent;"><span class="cl-ea91c976">Table 1: Summary statistics for trace element concentrations (mg/kg) in sediment or soil at Ashfield Flats. Abbreviations: n = number of valid observations; NAs = number of missing observations; n &gt; DGV is number of samples exceeding the sediment Default Guideline Value; n &gt; GV-high is number of samples exceeding the sediment upper Guideline Value at which toxicity effects might be expected (Water Quality Australia, 2024). HIL(C) is the human-health based investigation level for Recreational (public open space) land use (NEPC, 2013).</span></caption><thead><tr style="overflow-wrap:break-word;"><td class="cl-ea9aed9e"><p class="cl-ea9ad7c8"><span class="cl-ea975e04"></span></p></td><td class="cl-ea9aeda8"><p class="cl-ea9ad7d2"><span class="cl-ea975e04">As</span></p></td><td class="cl-ea9aeda8"><p class="cl-ea9ad7d2"><span class="cl-ea975e04">Cr</span></p></td><td class="cl-ea9aeda8"><p class="cl-ea9ad7d2"><span class="cl-ea975e04">Cu</span></p></td><td class="cl-ea9aeda8"><p class="cl-ea9ad7d2"><span class="cl-ea975e04">Mn</span></p></td><td class="cl-ea9aeda8"><p class="cl-ea9ad7d2"><span class="cl-ea975e04">Ni</span></p></td><td class="cl-ea9aeda8"><p class="cl-ea9ad7d2"><span class="cl-ea975e04">Pb</span></p></td><td class="cl-ea9aeda9"><p class="cl-ea9ad7d2"><span class="cl-ea975e04">Zn</span></p></td></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-ea9aedaa"><p class="cl-ea9ad7c8"><span class="cl-ea975e0e">mean</span></p></td><td class="cl-ea9aedb2"><p class="cl-ea9ad7d2"><span class="cl-ea975e0e">8.16</span></p></td><td class="cl-ea9aedb2"><p class="cl-ea9ad7d2"><span class="cl-ea975e0e">49.3</span></p></td><td class="cl-ea9aedb2"><p class="cl-ea9ad7d2"><span class="cl-ea975e0e">112</span></p></td><td class="cl-ea9aedb2"><p class="cl-ea9ad7d2"><span class="cl-ea975e0e">144</span></p></td><td class="cl-ea9aedb2"><p class="cl-ea9ad7d2"><span class="cl-ea975e0e">19</span></p></td><td class="cl-ea9aedb2"><p class="cl-ea9ad7d2"><span class="cl-ea975e0e">54.9</span></p></td><td class="cl-ea9aedb3"><p class="cl-ea9ad7d2"><span class="cl-ea975e0e">471</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-ea9aedaa"><p class="cl-ea9ad7c8"><span class="cl-ea975e0e">sd</span></p></td><td class="cl-ea9aedb2"><p class="cl-ea9ad7d2"><span class="cl-ea975e0e">7.71</span></p></td><td class="cl-ea9aedb2"><p class="cl-ea9ad7d2"><span class="cl-ea975e0e">20.6</span></p></td><td class="cl-ea9aedb2"><p class="cl-ea9ad7d2"><span class="cl-ea975e0e">121</span></p></td><td class="cl-ea9aedb2"><p class="cl-ea9ad7d2"><span class="cl-ea975e0e">309</span></p></td><td class="cl-ea9aedb2"><p class="cl-ea9ad7d2"><span class="cl-ea975e0e">8</span></p></td><td class="cl-ea9aedb2"><p class="cl-ea9ad7d2"><span class="cl-ea975e0e">84.6</span></p></td><td class="cl-ea9aedb3"><p class="cl-ea9ad7d2"><span class="cl-ea975e0e">1020</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-ea9aedaa"><p class="cl-ea9ad7c8"><span class="cl-ea975e0e">min</span></p></td><td class="cl-ea9aedb2"><p class="cl-ea9ad7d2"><span class="cl-ea975e0e">0.4</span></p></td><td class="cl-ea9aedb2"><p class="cl-ea9ad7d2"><span class="cl-ea975e0e">1</span></p></td><td class="cl-ea9aedb2"><p class="cl-ea9ad7d2"><span class="cl-ea975e0e">2</span></p></td><td class="cl-ea9aedb2"><p class="cl-ea9ad7d2"><span class="cl-ea975e0e">6</span></p></td><td class="cl-ea9aedb2"><p class="cl-ea9ad7d2"><span class="cl-ea975e0e">1</span></p></td><td class="cl-ea9aedb2"><p class="cl-ea9ad7d2"><span class="cl-ea975e0e">1</span></p></td><td class="cl-ea9aedb3"><p class="cl-ea9ad7d2"><span class="cl-ea975e0e">1</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-ea9aedaa"><p class="cl-ea9ad7c8"><span class="cl-ea975e0e">median</span></p></td><td class="cl-ea9aedb2"><p class="cl-ea9ad7d2"><span class="cl-ea975e0e">6.05</span></p></td><td class="cl-ea9aedb2"><p class="cl-ea9ad7d2"><span class="cl-ea975e0e">54.7</span></p></td><td class="cl-ea9aedb2"><p class="cl-ea9ad7d2"><span class="cl-ea975e0e">61</span></p></td><td class="cl-ea9aedb2"><p class="cl-ea9ad7d2"><span class="cl-ea975e0e">79</span></p></td><td class="cl-ea9aedb2"><p class="cl-ea9ad7d2"><span class="cl-ea975e0e">19</span></p></td><td class="cl-ea9aedb2"><p class="cl-ea9ad7d2"><span class="cl-ea975e0e">37.3</span></p></td><td class="cl-ea9aedb3"><p class="cl-ea9ad7d2"><span class="cl-ea975e0e">222</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-ea9aedaa"><p class="cl-ea9ad7c8"><span class="cl-ea975e0e">max</span></p></td><td class="cl-ea9aedb2"><p class="cl-ea9ad7d2"><span class="cl-ea975e0e">62</span></p></td><td class="cl-ea9aedb2"><p class="cl-ea9ad7d2"><span class="cl-ea975e0e">84</span></p></td><td class="cl-ea9aedb2"><p class="cl-ea9ad7d2"><span class="cl-ea975e0e">1010</span></p></td><td class="cl-ea9aedb2"><p class="cl-ea9ad7d2"><span class="cl-ea975e0e">3500</span></p></td><td class="cl-ea9aedb2"><p class="cl-ea9ad7d2"><span class="cl-ea975e0e">50</span></p></td><td class="cl-ea9aedb2"><p class="cl-ea9ad7d2"><span class="cl-ea975e0e">831</span></p></td><td class="cl-ea9aedb3"><p class="cl-ea9ad7d2"><span class="cl-ea975e0e">7560</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-ea9aedaa"><p class="cl-ea9ad7c8"><span class="cl-ea975e0e">n</span></p></td><td class="cl-ea9aedb2"><p class="cl-ea9ad7d2"><span class="cl-ea975e0e">323</span></p></td><td class="cl-ea9aedb2"><p class="cl-ea9ad7d2"><span class="cl-ea975e0e">336</span></p></td><td class="cl-ea9aedb2"><p class="cl-ea9ad7d2"><span class="cl-ea975e0e">327</span></p></td><td class="cl-ea9aedb2"><p class="cl-ea9ad7d2"><span class="cl-ea975e0e">336</span></p></td><td class="cl-ea9aedb2"><p class="cl-ea9ad7d2"><span class="cl-ea975e0e">327</span></p></td><td class="cl-ea9aedb2"><p class="cl-ea9ad7d2"><span class="cl-ea975e0e">336</span></p></td><td class="cl-ea9aedb3"><p class="cl-ea9ad7d2"><span class="cl-ea975e0e">332</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-ea9aedaa"><p class="cl-ea9ad7c8"><span class="cl-ea975e0e">NAs</span></p></td><td class="cl-ea9aedb2"><p class="cl-ea9ad7d2"><span class="cl-ea975e0e">13</span></p></td><td class="cl-ea9aedb2"><p class="cl-ea9ad7d2"><span class="cl-ea975e0e">0</span></p></td><td class="cl-ea9aedb2"><p class="cl-ea9ad7d2"><span class="cl-ea975e0e">9</span></p></td><td class="cl-ea9aedb2"><p class="cl-ea9ad7d2"><span class="cl-ea975e0e">0</span></p></td><td class="cl-ea9aedb2"><p class="cl-ea9ad7d2"><span class="cl-ea975e0e">9</span></p></td><td class="cl-ea9aedb2"><p class="cl-ea9ad7d2"><span class="cl-ea975e0e">0</span></p></td><td class="cl-ea9aedb3"><p class="cl-ea9ad7d2"><span class="cl-ea975e0e">4</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-ea9aedaa"><p class="cl-ea9ad7d3"><span class="cl-ea975e0e">n &gt; DGV</span></p></td><td class="cl-ea9aedb2"><p class="cl-ea9ad7dc"><span class="cl-ea975e0e">26</span></p></td><td class="cl-ea9aedb2"><p class="cl-ea9ad7dc"><span class="cl-ea975e0e">6</span></p></td><td class="cl-ea9aedb2"><p class="cl-ea9ad7dc"><span class="cl-ea975e0e">156</span></p></td><td class="cl-ea9aedb2"><p class="cl-ea9ad7dc"><span class="cl-ea975e0e">0</span></p></td><td class="cl-ea9aedb2"><p class="cl-ea9ad7dc"><span class="cl-ea975e0e">137</span></p></td><td class="cl-ea9aedb2"><p class="cl-ea9ad7dc"><span class="cl-ea975e0e">91</span></p></td><td class="cl-ea9aedb3"><p class="cl-ea9ad7dc"><span class="cl-ea975e0e">185</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-ea9aedaa"><p class="cl-ea9ad7c8"><span class="cl-ea975e0e">n &gt; GV-high</span></p></td><td class="cl-ea9aedb2"><p class="cl-ea9ad7d2"><span class="cl-ea975e0e">0</span></p></td><td class="cl-ea9aedb2"><p class="cl-ea9ad7d2"><span class="cl-ea975e0e">0</span></p></td><td class="cl-ea9aedb2"><p class="cl-ea9ad7d2"><span class="cl-ea975e0e">26</span></p></td><td class="cl-ea9aedb2"><p class="cl-ea9ad7d2"><span class="cl-ea975e0e">0</span></p></td><td class="cl-ea9aedb2"><p class="cl-ea9ad7d2"><span class="cl-ea975e0e">0</span></p></td><td class="cl-ea9aedb2"><p class="cl-ea9ad7d2"><span class="cl-ea975e0e">9</span></p></td><td class="cl-ea9aedb3"><p class="cl-ea9ad7d2"><span class="cl-ea975e0e">73</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-ea9aedbc"><p class="cl-ea9ad7c8"><span class="cl-ea975e0e">n &gt; HIL(C)</span></p></td><td class="cl-ea9aedbd"><p class="cl-ea9ad7d2"><span class="cl-ea975e0e">0</span></p></td><td class="cl-ea9aedbd"><p class="cl-ea9ad7d2"><span class="cl-ea975e0e">0</span></p></td><td class="cl-ea9aedbd"><p class="cl-ea9ad7d2"><span class="cl-ea975e0e">0</span></p></td><td class="cl-ea9aedbd"><p class="cl-ea9ad7d2"><span class="cl-ea975e0e">0</span></p></td><td class="cl-ea9aedbd"><p class="cl-ea9ad7d2"><span class="cl-ea975e0e">0</span></p></td><td class="cl-ea9aedbd"><p class="cl-ea9ad7d2"><span class="cl-ea975e0e">4</span></p></td><td class="cl-ea9aedbe"><p class="cl-ea9ad7d2"><span class="cl-ea975e0e">0</span></p></td></tr></tbody></table></div></template>
<div class="flextable-shadow-host" id="a9be93d7-edb3-45e3-bfa1-3f2b9fdb5388"></div>
<script>
var dest = document.getElementById("a9be93d7-edb3-45e3-bfa1-3f2b9fdb5388");
var template = document.getElementById("d19066b6-7c5a-4288-a172-0dbdbc2e4f21");
var caption = template.content.querySelector("caption");
var fantome = dest.attachShadow({mode: 'open'});
var templateContent = template.content;
fantome.appendChild(templateContent);
</script>

<p>
 
</p>
<p>The final table could now go into a report, and most readers would be
happy with its appearance. We could probably do something about the
alignment of the numeric columns, but decimal point alignment is not
available in <code>flextable</code> yet.</p>
<p>The next really useful type of information to obtain would be
<strong>where</strong> the samples which exceed environmental thresholds
are. That question leads us to another more basic question: “<em>How can
we map our data in R</em>,” and so further chapters will cover preparing
maps in R, and from there we can move on to spatial analysis.</p>
</div>
<div id="references" class="section level2">
<h2>References</h2>
<p>NEPC (National Environment Protection Council). (2013). Schedule
B(1): Guideline on the Investigation Levels for Soil and Groundwater.
<strong>In</strong> <em>National Environment Protection (Assessment of
Site Contamination) Measure (Amended)</em>. Commonwealth of
Australia.</p>
<p>Rate, A. W., &amp; McGrath, G. S. (2022). Data for assessment of
sediment, soil, and water quality at Ashfield Flats Reserve, Western
Australia. <em>Data in Brief</em>, <strong>41</strong>, 107970. <a
href="https://doi.org/10.1016/j.dib.2022.107970"
target="_blank">https://doi.org/10.1016/j.dib.2022.107970</a></p>
<p>Water Quality Australia. (2024). <em>Toxicant default guideline
values for sediment quality.</em> Department of Climate Change, Energy,
the Environment and Water, Government of Australia. Retrieved 2024-04-11
from <a
href="https://www.waterquality.gov.au/anz-guidelines/guideline-values/default/sediment-quality-toxicants"
target="_blank">https://www.waterquality.gov.au/anz-guidelines/guideline-values/default/sediment-quality-toxicants</a></p>
<p>
 
</p>
</div>

<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<script src="site_libs/header-attrs-2.16/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/navigation-1.1/tabsets.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>










<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<hr />
<p><a href="https://creativecommons.org/licenses/by-sa/4.0/" target="_blank"><strong>CC-BY-SA</strong></a> • All content by <a href="https://github.com/Ratey-AtUWA" target="_blank">Ratey-AtUWA</a>. My <a href="https://www.uwa.edu.au/schools/agriculture-and-environment" target="_blank">employer</a> does not necessarily know about or endorse the content of this website.<br>
<span style="font-size:9pt">Created with <span style="font-family: monospace;">rmarkdown</span> in <a href="https://www.rstudio.com/" target="_blank"><span class="fa fa-registered"></span> RStudio</a> using the <span style="font-family: monospace;">cyborg</span> theme from <a href="https://bootswatch.com/" target="_blank"><span class="fa fa-swatchbook"></span> Bootswatch</a> via the <span style="font-family: monospace;">bslib</span> package, and <a href="https://fontawesome.com/v5/search?o=r&m=free" target="_blank"><span class="fa fa-font-awesome"></span> fontawesome v5 icons</a>.</span></p>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>



</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
