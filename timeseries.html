<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Time series in R</title>

<script src="site_libs/header-attrs-2.17/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
<link href="site_libs/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-5.1.3/bootstrap.bundle.min.js"></script>
<script src="site_libs/bs3compat-0.4.0/transition.js"></script>
<script src="site_libs/bs3compat-0.4.0/tabs.js"></script>
<script src="site_libs/bs3compat-0.4.0/bs3compat.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-inverse  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">cyboRg</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fa fa-home"></span>
     
    Home
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fa fa-project-diagram"></span>
     
    Code
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="code.html">
        <span class="fa fa-arrow-circle-right"></span>
         
        All the code in one place
      </a>
    </li>
    <li>
      <a href="mapscode.html">
        <span class="fa fa-arrow-circle-right"></span>
         
        Maps and geostatistics
      </a>
    </li>
    <li>
      <a href="EDAcode.html">
        <span class="fa fa-arrow-circle-right"></span>
         
        Exploratory Data Analysis
      </a>
    </li>
    <li>
      <a href="CoDAcode.html">
        <span class="fa fa-arrow-circle-right"></span>
         
        Compositional Data Analysis
      </a>
    </li>
    <li>
      <a href="soilcode.html">
        <span class="fa fa-arrow-circle-right"></span>
         
        Soil science
      </a>
    </li>
    <li>
      <a href="filecode.html">
        <span class="fa fa-arrow-circle-right"></span>
         
        File conversions
      </a>
    </li>
    <li>
      <a href="biolcode.html">
        <span class="fa fa-arrow-circle-right"></span>
         
        Environmental Biology
      </a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fa fa-chalkboard-teacher"></span>
     
    Teaching
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="teaching.html">
        <span class="fa fa-arrow-circle-right"></span>
         
        All in one place
      </a>
    </li>
    <li>
      <a href="WhatsR.html">
        <span class="fa fa-arrow-circle-right"></span>
         
        Very basic R
      </a>
    </li>
    <li>
      <a href="Rbasics.html">
        <span class="fa fa-arrow-circle-right"></span>
         
        Intro to R
      </a>
    </li>
    <li>
      <a href="Rgraphs.html">
        <span class="fa fa-arrow-circle-right"></span>
         
        Intro to R graphics
      </a>
    </li>
    <li>
      <a href="transformR.html">
        <span class="fa fa-arrow-circle-right"></span>
         
        Variable distributions
      </a>
    </li>
    <li>
      <a href="meansR.html">
        <span class="fa fa-arrow-circle-right"></span>
         
        Comparing means
      </a>
    </li>
    <li>
      <a href="relationR.html">
        <span class="fa fa-arrow-circle-right"></span>
         
        Relationships
      </a>
    </li>
    <li>
      <a href="Rmaps.html">
        <span class="fa fa-arrow-circle-right"></span>
         
        Basic maps in R
      </a>
    </li>
    <li>
      <a href="geostats.html">
        <span class="fa fa-arrow-circle-right"></span>
         
        Geostatistics
      </a>
    </li>
    <li>
      <a href="vegan.html">
        <span class="fa fa-arrow-circle-right"></span>
         
        Multivariate eDNA
      </a>
    </li>
    <li>
      <a href="timeseries.html">
        <span class="fa fa-arrow-circle-right"></span>
         
        Time series
      </a>
    </li>
    <li>
      <a href="compositional_Pt0-Intro.html">
        <span class="fa fa-arrow-circle-right"></span>
         
        Compositional data analysis Intro
      </a>
    </li>
    <li>
      <a href="compositional_Pt1-PCA.html">
        <span class="fa fa-arrow-circle-right"></span>
         
        PCA for compositional data analysis
      </a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fa fa-bell"></span>
     
    Rants
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="rants.html">
        <span class="fa fa-comment-dots"></span>
         
        All the rants in one place
      </a>
    </li>
    <li>
      <a href="profmetal.html">
        <span class="fa fa-comment-dots"></span>
         
        profundus metallum
      </a>
    </li>
  </ul>
</li>
<li>
  <a href="images.html">
    <span class="fa fa-images"></span>
     
    Images
  </a>
</li>
<li>
  <a href="about.html">
    <span class="fa fa-address-card"></span>
     
    About
  </a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="social.html">
    <span class="fa fa-twitter"></span>
     
    Social
  </a>
</li>
<li>
  <a href="work.html">
    <span class="fa fa-user-graduate"></span>
     
    UWA
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Time series in R</h1>

</div>


<p><img src="timeseries_files/figure-html/page%201%20header%20hide%20code-1.png" width="100%" style="display: block; margin: auto 0 auto auto;" /></p>
<div id="set-up-the-r-environment-for-time-series-analysis"
class="section level1">
<h1>Set up the R environment for time series analysis</h1>
<p>We will need the additional functions in several <strong>R</strong>
packages for specialized time series and other functions in R...</p>
<pre class="r"><code># Load the packages we need 
library(zoo)      # for basic irregular time series functions
library(xts)      # we need the xts &quot;eXtended Time Series&quot; format for some functions
library(Kendall)  # for trend analysis with Mann-Kendall test
library(trend)    # for trend analysis using the Sen slope
library(forecast) # for time series forecasting with ARIMA and exponential smoothing 
library(tseries)  # for assessing stationarity using Augmented Dickey-Fuller test
library(lmtest)   # for Breusch-Pagan heteroscedasticity test etc.
library(car)      # for various commonly-used functions
library(ggplot2)  # alternative to base R plots

# (optional) make a better colour palette than the R default!
palette(c(&quot;black&quot;,&quot;red3&quot;,&quot;purple&quot;,&quot;blue2&quot;,
          &quot;darkcyan&quot;,&quot;green3&quot;,&quot;sienna&quot;,&quot;gray50&quot;))
par(mfrow = c(3,1), mar = c(4,4,1,1), mgp = c(1.7,0.3,0), tcl = 0.3, font.lab=2)</code></pre>
</div>
<div id="data-input" class="section level1">
<h1>Data input</h1>
<p>Read the data into a data frame - this is how R often stores data -
it's not the format we need but we'll use it for comparison.</p>
<div id="non-time-series-object-for-comparison" class="section level2">
<h2>Non-time series object for comparison</h2>
<pre class="r"><code>soiltemp &lt;- read.csv(&quot;soiltemp2.csv&quot;)
colnames(soiltemp) &lt;- c(&quot;Date&quot;,&quot;temp&quot;)</code></pre>
</div>
<div id="do-some-checks-of-the-data" class="section level2">
<h2>Do some checks of the data</h2>
<pre class="r"><code>summary(soiltemp) # simple summary of each column</code></pre>
<pre><code>##      Date                temp      
##  Length:1464        Min.   :10.40  
##  Class :character   1st Qu.:12.45  
##  Mode  :character   Median :14.30  
##                     Mean   :14.86  
##                     3rd Qu.:17.41  
##                     Max.   :21.70</code></pre>
<pre class="r"><code>str(soiltemp) # more detailed information about the R object (&#39;str&#39;=structure)</code></pre>
<pre><code>## &#39;data.frame&#39;:    1464 obs. of  2 variables:
##  $ Date: chr  &quot;2014-04-01 00:00:00&quot; &quot;2014-04-01 01:00:00&quot; &quot;2014-04-01 02:00:00&quot; &quot;2014-04-01 03:00:00&quot; ...
##  $ temp: num  20.1 19.8 19.6 19.2 19 ...</code></pre>
<div id="check-with-a-plot" class="section level3">
<h3>Check with a plot</h3>
<pre class="r"><code>plot(soiltemp$temp, type = &quot;l&quot;, col = 4)</code></pre>
<div class="figure" style="text-align: center">
<img src="timeseries_files/figure-html/plot-df-1.png" alt="Figure 1: Plot of soil temperature time series data which is not (yet) formatted as a time series." width="50%" />
<p class="caption">
Figure 1: Plot of soil temperature time series data which is not (yet)
formatted as a time series.
</p>
</div>
<p>
 
</p>
<p>The horizontal axis in Figure 1 is just the row number of the data
frame, not a date or time. We really want the data in a different type
of R object! We use the <code>read.csv.zoo()</code> function in the
<code>zoo</code> package to read the data in as a time series. This
gives a data object of class 'zoo' which is much more flexible than the
default time series object in R.</p>
<pre class="r"><code>soiltemp_T15_zoo &lt;- read.csv.zoo(&quot;soiltemp2.csv&quot;,
                               format = &quot;%Y-%m-%d %H:%M:%S&quot;, 
                               tz = &quot;Australia/Perth&quot;, 
                               index.column=1,
                               header = TRUE)
# do some quick checks of the new R object:
summary(soiltemp_T15_zoo) </code></pre>
<pre><code>##      Index                     soiltemp_T15_zoo
##  Min.   :2014-04-01 00:00:00   Min.   :10.40   
##  1st Qu.:2014-04-16 05:45:00   1st Qu.:12.45   
##  Median :2014-05-01 11:30:00   Median :14.30   
##  Mean   :2014-05-01 11:30:00   Mean   :14.86   
##  3rd Qu.:2014-05-16 17:15:00   3rd Qu.:17.41   
##  Max.   :2014-05-31 23:00:00   Max.   :21.70</code></pre>
<pre class="r"><code>str(soiltemp_T15_zoo) # POSIXct in the output is a date-time format</code></pre>
<pre><code>## &#39;zoo&#39; series from 2014-04-01 to 2014-05-31 23:00:00
##   Data: num [1:1464] 20.1 19.8 19.6 19.2 19 ...
##   Index:  POSIXct[1:1464], format: &quot;2014-04-01 00:00:00&quot; &quot;2014-04-01 01:00:00&quot; &quot;2014-04-01 02:00:00&quot; &quot;2014-04-01 03:00:00&quot; ...</code></pre>
<p>It's usually useful to check our data with a plot (Figure 2)</p>
<pre class="r"><code>plot(soiltemp_T15_zoo, col = 2) </code></pre>
<div class="figure" style="text-align: center">
<img src="timeseries_files/figure-html/plot-zoo-1.png" alt="Figure 2: Plot of soil temperature time series data which is formatted as a zoo time series object." width="50%" />
<p class="caption">
Figure 2: Plot of soil temperature time series data which is formatted
as a zoo time series object.
</p>
</div>
<p>
 
</p>
<p>Sometimes we need to use another time series data format,
<code>xts</code> (e<u>X</u>tended <u>T</u>ime <u>S</u>eries), which
allows us to use more functions...</p>
</div>
<div id="make-an-xts-object-from-our-zoo-object" class="section level3">
<h3>Make an xts object from our zoo object</h3>
<pre class="r"><code>soiltemp_T15_xts &lt;- as.xts(soiltemp_T15_zoo)
str(soiltemp_T15_xts) # just to check</code></pre>
<pre><code>## An &#39;xts&#39; object on 2014-04-01/2014-05-31 23:00:00 containing:
##   Data: num [1:1464, 1] 20.1 19.8 19.6 19.2 19 ...
##   Indexed by objects of class: [POSIXct,POSIXt] TZ: Australia/Perth
##   xts Attributes:  
##  NULL</code></pre>
<p>
 
</p>
</div>
</div>
</div>
<div id="exploratory-data-analysis-of-time-series"
class="section level1">
<h1>Exploratory data analysis of time series</h1>
<p>We first examine a plot of the data in our time series object (the
plot for the <code>xts</code> time series object is in Figure 3).</p>
<pre class="r"><code>plot(soiltemp_T15_xts, col = 3, ylab = &quot;Soil temperature (\u00B0C)&quot;) # just to check</code></pre>
<div class="figure" style="text-align: center">
<img src="timeseries_files/figure-html/plot-xts-1.png" alt="Figure 3: Plot of soil temperature time series data which is formatted as an xts time series object." width="60%" />
<p class="caption">
Figure 3: Plot of soil temperature time series data which is formatted
as an xts time series object.
</p>
</div>
<p>
 
</p>
<p>Plotting the time series variable (with time as the independent
variable!) can give us some initial clues about the overall trend in the
data (in Figure 3, a negative overall slope) and if there is any
periodicity (there do seem to be regular increases and decreases in soil
temperature). The plot in Figure 3 also shows that plotting an
<code>xts</code> time series object gives a somewhat more detailed plot
than for a <code>zoo</code> formatted time series object (Figure 2).</p>
<p>We often want to inspect plots of both the raw data and using common
transformations (Figure 4). We compare with transformed time series data
- we may need to do this to meet later modelling assumptions.</p>
<p>First we change the default plotting parameters using
<code>par(...)</code>, then plot the object and some transformed
versions (with custom axis labels).</p>
<pre class="r"><code>par(mfrow = c(3,1), mar = c(4,4,1,1), mgp = c(1.7,0.3,0), tcl = 0.3, font.lab=2)

plot(soiltemp_T15_zoo, ylab = &quot;Temperature (\u00B0C)&quot;,
     xlab = &quot;Date&quot;, col = 7, lwd = 2, cex.lab = 1.4)

plot(log10(soiltemp_T15_zoo), 
     ylab = expression(bold(paste(log[10],&quot;(Temperature, \u00B0C)&quot;))),
     xlab = &quot;Date&quot;, col = 3, lwd = 2, cex.lab = 1.4)

pt0 &lt;- powerTransform(coredata(soiltemp_T15_zoo))
if(pt0$lambda&lt;0) {
  plot(
    -1 * (soiltemp_T15_zoo ^ pt0$lambda),
    ylab = &quot;power-transf. (Temp., \u00B0C)&quot;,
    xlab = &quot;Date&quot;,
    col = 4, lwd = 2, cex.lab = 1.4
  )
} else {
  plot((soiltemp_T15_zoo ^ pt0$lambda),
       ylab = &quot;power-transf. (Temp., \u00B0C)&quot;,
       xlab = &quot;Date&quot;,
       col = 4, lwd = 2, cex.lab = 1.4
  )
}</code></pre>
<div class="figure" style="text-align: center">
<img src="timeseries_files/figure-html/plot-transf-1.png" alt="Figure 4: Plots of soil temperature time series data as untransformed, log10-transformed, and power transformed values." width="65%" />
<p class="caption">
Figure 4: Plots of soil temperature time series data as untransformed,
log10-transformed, and power transformed values.
</p>
</div>
<p>
 
</p>
<blockquote>
<p>Which of these plots looks like it might be homoscedastic,
<em>i.e</em>., have constant variance regardless of time?</p>
</blockquote>
<p>The R Cookbook suggests Box-Cox (power) transforming the variable to
"stabilize the variance" (<em>i.e</em>. reduce heteroscedasticity). This
does work, but can be better to use log<sub>10</sub>[conc], as the
values are easier to interpret.</p>
<p>If we think a transformation is needed, then run something like the
code below (which does a square root transformation, <em>i.e</em>.
variable<sup>0.5</sup>). This is just an example -- we may, for example,
decide that the log<sub>10</sub>-transformation is more suitable.</p>
<pre class="r"><code>soiltemp_T15_zoo &lt;- soiltemp_T15_zoo^0.5 ####  don&#39;t run this chunk of code...
# don&#39;t forget the xts version either!
soiltemp_T15_xts &lt;- as.xts(soiltemp_T15_zoo) # ...it&#39;s just an example 😊</code></pre>
<div id="assessing-if-a-time-series-variable-is-stationary"
class="section level2">
<h2>Assessing if a time series variable is stationary</h2>
<p>A <strong>stationary</strong> variable's mean and variance are not
dependent on time. In other words, for a stationary series, the mean and
variance at any time are representative of the whole series.</p>
<p>If there is a trend for the value of the variable to increase or
decrease, or if there are periodic fluctuations, we don't have a
stationary time series.</p>
<p>Many useful statistical analyses and models for time series models
need a stationary time series as input, or a time series that can be
made stationary with transformations or differencing.</p>
</div>
<div id="testing-for-stationarity" class="section level2">
<h2>Testing for stationarity</h2>
<pre class="r"><code># we need the package &#39;tseries&#39; for the Augmented Dickey–Fuller (adf) Test
d0 &lt;- adf.test(soiltemp_T15_zoo); print(d0)</code></pre>
<pre><code>## 
##  Augmented Dickey-Fuller Test
## 
## data:  soiltemp_T15_zoo
## Dickey-Fuller = -3.9515, Lag order = 11, p-value = 0.01141
## alternative hypothesis: stationary</code></pre>
<pre class="r"><code>d1 &lt;- adf.test(diff(soiltemp_T15_zoo,1)); print(d1)</code></pre>
<pre><code>## Warning in adf.test(diff(soiltemp_T15_zoo, 1)): p-value smaller than printed p-value</code></pre>
<pre><code>## 
##  Augmented Dickey-Fuller Test
## 
## data:  diff(soiltemp_T15_zoo, 1)
## Dickey-Fuller = -16.143, Lag order = 11, p-value = 0.01
## alternative hypothesis: stationary</code></pre>
<pre class="r"><code>d2 &lt;- adf.test(diff(diff(soiltemp_T15_zoo,1),1)); print(d2)</code></pre>
<pre><code>## Warning in adf.test(diff(diff(soiltemp_T15_zoo, 1), 1)): p-value smaller than printed p-value</code></pre>
<pre><code>## 
##  Augmented Dickey-Fuller Test
## 
## data:  diff(diff(soiltemp_T15_zoo, 1), 1)
## Dickey-Fuller = -17.204, Lag order = 11, p-value = 0.01
## alternative hypothesis: stationary</code></pre>
</div>
<div id="plot-differencing-for-stationarity" class="section level2">
<h2>Plot differencing for stationarity</h2>
<p>The plots in Figure 5 below show that constant mean and variance
(<em>i.e</em>. stationarity) is achieved after a single differencing
step. The <code>adf.test</code> p-value suggests that the
non-differenced series is already stationary, but the first sub-plot in
Figure 5 does not support this.</p>
<pre class="r"><code>par(mfrow = c(3,1), mar = c(0,4,0,1), oma = c(4,0,1,0), cex.lab = 1.4,
    mgp = c(2.5,0.7,0), font.lab = 2)
plot(soiltemp_T15_zoo, ylab = &quot;Raw data, no differencing&quot;,
     xlab=&quot;&quot;, xaxt=&quot;n&quot;, col = 8)
lines(loess.smooth(index(soiltemp_T15_zoo),coredata(soiltemp_T15_zoo)), 
      col = 4, lwd = 2)
abline(lm(coredata(soiltemp_T15_zoo) ~ index(soiltemp_T15_zoo)), col = 2)
legend(&quot;topright&quot;, legend = c(&quot;soiltemp_T15_Data&quot;, &quot;Loess smoothing&quot;,&quot;Linear model&quot;),
       cex = 1.8, col = c(1,4,2), lwd = c(1,2,1), bty = &quot;n&quot;)
mtext(paste(&quot;adf.test p value =&quot;,signif(d0$p.value,3)), 
      side = 1, line = -1.2, adj = 0.05)
plot(diff(soiltemp_T15_zoo,1),
     ylab = &quot;First differencing&quot;,
     xlab=&quot;&quot;, xaxt=&quot;n&quot;, col = 8)
abline(h = 0, col = &quot;grey&quot;, lty = 2)
lines(loess.smooth(index(diff(soiltemp_T15_zoo,1)),coredata(diff(soiltemp_T15_zoo,1))), 
      col = 4, lwd = 2)
abline(lm(coredata(diff(soiltemp_T15_zoo,1)) ~
            index(diff(soiltemp_T15_zoo,1))), col = 2)
mtext(paste(&quot;adf.test p value =&quot;,signif(d1$p.value,3)), 
      side = 1, line = -1.2, adj = 0.05)
plot(diff(diff(soiltemp_T15_zoo,1),1),
     ylab = &quot;Second differencing&quot;,
     xlab=&quot;Date&quot;, col = 8)
mtext(&quot;Date&quot;,side = 1, line = 2.2, font = 2)
abline(h = 0, col = &quot;grey&quot;, lty = 2)
lines(loess.smooth(index(diff(diff(soiltemp_T15_zoo,1),1)),
                   coredata(diff(diff(soiltemp_T15_zoo,1),1))), 
      col = 4, lwd = 2)
abline(lm(coredata(diff(diff(soiltemp_T15_zoo,1))) ~ 
            index(diff(diff(soiltemp_T15_zoo,1)))), col = 2)
mtext(paste(&quot;adf.test p value =&quot;,signif(d2$p.value,3)), 
      side = 1, line = -1.2, adj = 0.05)</code></pre>
<div class="figure" style="text-align: center">
<img src="timeseries_files/figure-html/plot-diff-1.png" alt="Figure 5: Plots of soil temperature time series data and its first and second differences, with each sub-plot showing the smoothed (Loess) and linear trends." width="65%" />
<p class="caption">
Figure 5: Plots of soil temperature time series data and its first and
second differences, with each sub-plot showing the smoothed (Loess) and
linear trends.
</p>
</div>
<p>
 
</p>
</div>
<div id="finding-the-trend" class="section level2">
<h2>Finding the trend</h2>
<div id="determine-if-there-is-actually-any-trend"
class="section level3">
<h3>1. Determine if there is actually any trend</h3>
<table border="1">
<tr>
<td style="background-color:#ffffe0; padding:8px;">
<span style="font-size:13pt;">Simply <strong>finding whether there is a
significant trend, and the direction of that trend</strong>
(<em>i.e</em>. negative = decreasing or positive = increasing) may be
sufficient from a regulatory perspective.</span> For example when
monitoring the attenuation of pollution or checking the effectiveness of
remediation, showing that the contaminant concentrations are decreasing
is important information! (see Australian Government 2023; Department of
Water 2015).</span>
</td>
</tr>
</table>
<div id="a.-apply-the-mann-kendall-test-from-the-trend-package"
class="section level4">
<h4>1a. Apply the Mann-Kendall test from the 'trend' package</h4>
<pre class="r"><code>mk.test(coredata(soiltemp_T15_zoo))</code></pre>
<pre><code>## 
##  Mann-Kendall trend test
## 
## data:  coredata(soiltemp_T15_zoo)
## z = -36.387, n = 1464, p-value &lt; 2.2e-16
## alternative hypothesis: true S is not equal to 0
## sample estimates:
##             S          varS           tau 
## -6.797270e+05  3.489630e+08 -6.371125e-01</code></pre>
<pre class="r"><code>#    or
# SeasonalMannKendall(soiltemp_T15_zoo) # needs base R regular time series object</code></pre>
<p>The output from <code>mk.test()</code> shows a negative slope
(<em>i.e</em>. the value of <code>S</code>), with the
<code>p-value</code> definitely &lt; 0.05, so we can reject the null
hypothesis of zero slope.</p>
</div>
<div id="b.-estimate-the-sens-slope" class="section level4">
<h4>1b. Estimate the Sen's slope</h4>
<pre class="r"><code>sens.slope(coredata(soiltemp_T15_zoo))</code></pre>
<pre><code>## 
##  Sen&#39;s slope
## 
## data:  coredata(soiltemp_T15_zoo)
## z = -36.387, n = 1464, p-value &lt; 2.2e-16
## alternative hypothesis: true z is not equal to 0
## 95 percent confidence interval:
##  -0.005963303 -0.005570410
## sample estimates:
##  Sen&#39;s slope 
## -0.005765595</code></pre>
<p>The output from <code>sens.slope()</code> also shows a negative slope
(<em>i.e</em>. the value of <code>Sen's slope</code> at the end of the
output block). Again, the <code>p-value</code> is &lt; 0.05, so we can
reject the null hypothesis of zero slope. The
<code>95 percent confidence interval</code> does not include zero, also
showing that the Sen's slope is significantly negative in this
example.</p>
</div>
</div>
<div id="visualising-a-trend-using-a-moving-average"
class="section level3">
<h3>2. Visualising a trend using a moving average</h3>
<p>We create a new time series from a moving average for each 24h to
remove daily periodicity using the <code>rollmean()</code> function from
the <code>zoo</code> package. We know these are hourly data with diurnal
fluctuation, so a rolling mean for chunks of length 24 should be OK, and
this seems to be true based on Figure 6. In some cases the
<code>findfrequency()</code> function from the <code>xts</code> package
can detect the periodic frequency for us. A moving average will always
smooth our data, so a smooth curve doesn't necessarily mean that we have
periodicity (seasonality).</p>
<table border="1">
<tr>
<td style="background-color: #ffffe0; padding:8px;">
<p><span style="font-size:12pt;"><strong>Moving averages</strong> are
important parts of the <strong>ARIMA</strong> family of predictive
models for time series, and that's why we show them here
first.</span></p>
There are probably better ways of drawing smooth curves to represent our
time series data (see below).
</td>
</tr>
</table>
<p>
 
</p>
<pre class="r"><code>ff &lt;- findfrequency(soiltemp_T15_xts) # often an approximation!! check the data!
cat(&quot;Estimated frequency is&quot;,ff,&quot;\n&quot;)</code></pre>
<pre><code>## Estimated frequency is 24</code></pre>
<pre class="r"><code>soiltemp_T15_movAv &lt;- rollmean(soiltemp_T15_zoo, 24)
plot(soiltemp_T15_zoo, col=8, type=&quot;l&quot;) # original data
# add the moving average
lines(soiltemp_T15_movAv, lwd = 2)
legend(&quot;topright&quot;, legend = c(&quot;Data&quot;,&quot;Moving average&quot;), col = c(8,1), lwd = c(1,2))</code></pre>
<div class="figure" style="text-align: center">
<img src="timeseries_files/figure-html/plot-movAv-1.png" alt="Figure 6: Plots of soil temperature time series data and the 24-hour moving average." width="55%" />
<p class="caption">
Figure 6: Plots of soil temperature time series data and the 24-hour
moving average.
</p>
</div>
<p>
 
</p>
</div>
<div id="showing-a-trend-using-a-linear-regression-model"
class="section level3">
<h3>3. Showing a trend using a linear (regression) model</h3>
<p>This is just to <strong>visualize</strong> the trend – remember, to
find if a trend exists, we use the Mann-Kendall test or Sen's Slope test
as descrobed above.</p>
<p>First we create a linear model of the time series...</p>
<pre class="r"><code>lm0 &lt;- lm(coredata(soiltemp_T15_zoo) ~ index(soiltemp_T15_zoo))
summary(lm0)</code></pre>
<pre><code>## 
## Call:
## lm(formula = coredata(soiltemp_T15_zoo) ~ index(soiltemp_T15_zoo))
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -3.9217 -1.0968  0.0743  1.0938  3.5318 
## 
## Coefficients:
##                           Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)              2.213e+03  3.370e+01   65.66   &lt;2e-16 ***
## index(soiltemp_T15_zoo) -1.571e-06  2.409e-08  -65.22   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 1.402 on 1462 degrees of freedom
## Multiple R-squared:  0.7442, Adjusted R-squared:  0.744 
## F-statistic:  4253 on 1 and 1462 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>...then use a plot (Figure 7) to look at the linear relationship.</p>
<pre class="r"><code>soiltemp_T15_lmfit &lt;- zoo(lm0$fitted.values, index(soiltemp_T15_zoo))
plot(soiltemp_T15_zoo, col = 8, type = &quot;l&quot;)
lines(soiltemp_T15_lmfit, col = 2, lty = 2)
legend(&quot;topright&quot;, legend = c(&quot;Data&quot;,&quot;Linear trend&quot;), col = c(8,2), lty = c(1,2))</code></pre>
<div class="figure" style="text-align: center">
<img src="timeseries_files/figure-html/linear-trend-1.png" alt="Figure 7: Plots of soil temperature time series data and the overall trend shown by a linear model." width="55%" />
<p class="caption">
Figure 7: Plots of soil temperature time series data and the overall
trend shown by a linear model.
</p>
</div>
<p>
 
</p>
<p>Figure 7 shows that a linear model does not really capture the trend
(ignoring the periodicity) very convincingly. The next option 'loess'
smoothing option below tries to present the trend more accurately.</p>
</div>
<div id="using-locally-estimated-scatterplot-smoothing-loess"
class="section level3">
<h3>4. Using Locally Estimated Scatterplot Smoothing (loess)</h3>
<p><strong>loess</strong>, sometimes called 'lowess' is a form of
locally weighted non-parametric regression to fit smooth curves to
data). The amount of smoothing is controlled by the <code>span =</code>
parameter in the <code>loess.smooth()</code> function (from base
<strong>R</strong>) – see the example using the soil temperature data in
Figure 8.</p>
<p><strong>NOTE</strong>: loess smoothing does not have the relationship
to ARIMA that moving averaging does, but does allow us to separate
periodicity from random error in time series decomposition.</p>
<pre class="r"><code>y_trend &lt;- loess.smooth(index(soiltemp_T15_zoo), 
                           coredata(soiltemp_T15_zoo), 
                           span = 0.15, evaluation = length(soiltemp_T15_zoo))
plot(soiltemp_T15_zoo, col = 8, type = &quot;l&quot;)
soiltemp_T15_trend &lt;- zoo(y_trend$y, index(soiltemp_T15_zoo))
lines(soiltemp_T15_lmfit, col = 2, lty = 2)
lines(soiltemp_T15_trend, col = &quot;skyblue&quot;, lwd = 3)
legend(&quot;topright&quot;, bty = &quot;n&quot;, inset = 0.02, cex = 1.25, 
       legend = c(&quot;actual data&quot;,&quot;linear model&quot;,&quot;loess smoothed&quot;), 
       col = c(8,2,&quot;skyblue&quot;), lty=c(1,2,1), lwd = c(1,1,3))</code></pre>
<div class="figure" style="text-align: center">
<img src="timeseries_files/figure-html/loess-trend-1.png" alt="Figure 8: Plots of soil temperature time series data and the overall trend shown by a loess smoothing model." width="55%" />
<p class="caption">
Figure 8: Plots of soil temperature time series data and the overall
trend shown by a loess smoothing model.
</p>
</div>
<p>
 
</p>
</div>
</div>
<div id="isolating-the-time-series-periodicity" class="section level2">
<h2>Isolating the Time Series Periodicity</h2>
<p><span style="font-size:14pt; color:#600080"><strong>NOTE THAT TIME
SERIES DON'T ALWAYS HAVE PERIODICITY !</strong></span></p>
<p>To model the periodicity we need to understand the autocorrelation
structure of the time series. We can do this graphically, first by
plotting the autocorrelation function <code>acf()</code> which outputs a
plot by default:</p>
<pre class="r"><code>acf(soiltemp_T15_xts, main = &quot;&quot;)</code></pre>
<div class="figure" style="text-align: center">
<img src="timeseries_files/figure-html/acf-plot-1.png" alt="Figure 9: The autocorrelation function plot for soil temperature time series data (the horizontal axis is in units of seconds)." width="65%" />
<p class="caption">
Figure 9: The autocorrelation function plot for soil temperature time
series data (the horizontal axis is in units of seconds).
</p>
</div>
<p>
 
</p>
<blockquote>
<p>What does Figure 9 tell you about autocorrelation in this time
series?</p>
</blockquote>
<p>Then plot the partial autocorrelation function
(<code>pacf()</code>)</p>
<pre class="r"><code>pacf(soiltemp_T15_xts, main = &quot;&quot;)</code></pre>
<div class="figure" style="text-align: center">
<img src="timeseries_files/figure-html/pacf-plot-1.png" alt="Figure 10: The partial autocorrelation function plot for soil temperature time series data (horizontal axis units are seconds)." width="65%" />
<p class="caption">
Figure 10: The partial autocorrelation function plot for soil
temperature time series data (horizontal axis units are seconds).
</p>
</div>
<p>
 
</p>
<p>Interpreting partial autocorrelations (Figure 10) is more complicated
- refer to Long &amp; Teetor (2019, <em>Section 14.15</em>).
Simplistically, partial autocorrelation allows us to identify which and
how many autocorrelations will be needed to model the time series
data.</p>
<div id="we-use-the-box-pierce-test-for-autocorrelation"
class="section level3">
<h3>We use the 'Box-Pierce test' for autocorrelation</h3>
<p>The null hypothesis H<sub>0</sub> is that no autocorrelation exists
at any lag distance (so p <span class="math inline">\(\le\)</span> 0.05
'rejects' H<sub>0</sub>):</p>
<pre class="r"><code>Box.test(soiltemp_T15_xts)</code></pre>
<pre><code>## 
##  Box-Pierce test
## 
## data:  soiltemp_T15_xts
## X-squared = 1436.3, df = 1, p-value &lt; 2.2e-16</code></pre>
<pre class="r"><code>Box.test(diff(soiltemp_T15_xts,1)) # 1 difference</code></pre>
<pre><code>## 
##  Box-Pierce test
## 
## data:  diff(soiltemp_T15_xts, 1)
## X-squared = 15.658, df = 1, p-value = 7.589e-05</code></pre>
<pre class="r"><code>Box.test(diff(diff(soiltemp_T15_xts,1),1)) # 2 differences</code></pre>
<pre><code>## 
##  Box-Pierce test
## 
## data:  diff(diff(soiltemp_T15_xts, 1), 1)
## X-squared = 357.45, df = 1, p-value &lt; 2.2e-16</code></pre>
</div>
<div id="make-a-time-series-of-the-loess-residuals"
class="section level3">
<h3>Make a time series of the loess residuals</h3>
<p>Remember that we made a loess model of the time series ... the
residuals (Figure 11) can give us the combination of periodicity
component plus any random variation.</p>
<pre class="r"><code>soiltemp_T15_periodic &lt;- soiltemp_T15_zoo - soiltemp_T15_trend
plot(soiltemp_T15_trend, ylim = c(-2,20), lty = 3)
lines(soiltemp_T15_periodic, col = &quot;coral&quot;, lwd = 2) # just to check
legend(&quot;topright&quot;, legend = c(&quot;LOESS trend&quot;, &quot;Periodicity plus noise&quot;), 
       col = c(1,&quot;coral&quot;), lwd = c(1,2), lty = c(3,1))</code></pre>
<div class="figure" style="text-align: center">
<img src="timeseries_files/figure-html/loess-resids-1.png" alt="Figure 11: An incomplete decomposition of the soil temperature time series into smoothed trend and periodicity plus error (noise) components." width="55%" />
<p class="caption">
Figure 11: An incomplete decomposition of the soil temperature time
series into smoothed trend and periodicity plus error (noise)
components.
</p>
</div>
<p>
 
</p>
<p>We can also use <em>less smoothing</em> in the loess function to
<em>retain</em> periodicity; we adjust the <code>span&amp;nbsp;=</code>
option (lower values of <code>span</code> give less smoothing; we just
need to experiment with different values). The difference between the
data and the less-smoothed loess should be just 'noise' or
'<strong>error</strong>'.</p>
<p>We first generate a loess model which is stored in the object
<code>temp_LOESS2</code>:</p>
<pre class="r"><code>temp_LOESS2 &lt;- loess.smooth(index(soiltemp_T15_zoo), 
                           coredata(soiltemp_T15_zoo), 
                           span = 0.012, evaluation = length(soiltemp_T15_zoo))</code></pre>
<p>We then use the new loess model to make a time series which contains
both periodic and trend information:</p>
<pre class="r"><code>soiltemp_T15_LOESS2 &lt;- zoo(temp_LOESS2$y, index(soiltemp_T15_zoo))</code></pre>
<p>The difference between the data and the less-smoothed loess should be
just 'noise' or 'error', so we make a new time series based on this
difference:</p>
<pre class="r"><code>soiltemp_T15_err &lt;- soiltemp_T15_zoo - soiltemp_T15_LOESS2</code></pre>
<p><br />
</p>
<div id="plot-setting-y-axis-limits-to-similar-scale-to-original-data"
class="section level4">
<h4>Plot, setting y axis limits to similar scale to original data:</h4>
<pre class="r"><code>par(mar = c(4,4,1,1), mgp = c(1.7,0.3,0), tcl = 0.3, font.lab = 2)
plot(soiltemp_T15_trend, ylim = c(-2,20), lty = 2, lwd = 2, # from above
     xlab = &quot;2014 Date&quot;, ylab = &quot;Soil temperature (\u00B0C)&quot;)
lines(soiltemp_T15_LOESS2, col = 3, lwd = 2)
lines(soiltemp_T15_err, col = 2) # from a couple of lines above
legend(&quot;left&quot;, 
       legend = c(&quot;Trend (coarse LOESS)&quot;, 
                  &quot;Periodicity + trend (fine LOESS)&quot;,
                  &quot;Unexplained variation&quot;), 
       col = c(1,3,2), lwd = c(2,2,1), lty = c(2,1,1), bty=&quot;n&quot;)</code></pre>
<div class="figure" style="text-align: center">
<img src="timeseries_files/figure-html/loess-periodic-1.png" alt="Figure 12: Incomplete decomposition of soil temperature time series data showing the smoothed *trend*, combined *trend + periodicity*, and *error* components." width="55%" />
<p class="caption">
Figure 12: Incomplete decomposition of soil temperature time series data
showing the smoothed <em>trend</em>, combined <em>trend +
periodicity</em>, and <em>error</em> components.
</p>
</div>
<p>
 
</p>
<p>The periodicity by itself should be represented by the difference
between the very smoothed (trend) and less smoothed (trend +
periodicity) loess, as suggested by the two loess curves in Figure 12.
We now make yet another time series object to hold this isolated
periodicity:</p>
<pre class="r"><code>soiltemp_T15_periodic2 &lt;- soiltemp_T15_LOESS2 - soiltemp_T15_trend</code></pre>
</div>
</div>
<div
id="plot-everything-to-show-the-components-of-time-series-decomposition"
class="section level3">
<h3>Plot everything to show the components of time series
decomposition</h3>
<pre class="r"><code>plot(cbind(soiltemp_T15_zoo,soiltemp_T15_periodic2,
     soiltemp_T15_trend, soiltemp_T15_err), main = &quot;&quot;, xlab = &quot;Date in 2014&quot;, 
     cex.main = 1.5, yax.flip = TRUE, col = c(8,3,4,2), 
     ylim = c(floor(min(soiltemp_T15_periodic2)), ceiling(max(soiltemp_T15_zoo))))
x1 &lt;- (0.5*(par(&quot;usr&quot;)[2]-par(&quot;usr&quot;)[1]))+par(&quot;usr&quot;)[1]
y &lt;- (c(0.15, 0.3, 0.6, 0.82)*(par(&quot;usr&quot;)[4]-par(&quot;usr&quot;)[3]))+par(&quot;usr&quot;)[3]
text(rep(x1,4), y, 
     labels = c(&quot;Unaccounted variation&quot;,&quot;Trend&quot;,&quot;Apparent periodicity&quot;,&quot;Data&quot;), 
     col = c(2,4,3,8))</code></pre>
<div class="figure" style="text-align: center">
<img src="timeseries_files/figure-html/decomp-plots-1.png" alt="Figure 13: Time series decomposition into the three main components (periodicity, trend, and error; the raw data are at the top) for soil temperature (°C) at 15 cm depth." width="768" />
<p class="caption">
Figure 13: Time series decomposition into the three main components
(periodicity, trend, and error; the raw data are at the top) for soil
temperature (°C) at 15 cm depth.
</p>
</div>
<p>
 
</p>
<p>Figure 13 shows the original time series data, and the three
important components of the decomposed time series: the
<em>periodicity</em>, the <em>trend</em>, and the <em>error</em> or
unexplained variation. We should remember that:</p>
<ul>
<li>this time series was relatively easy to decompose into its
components, but not all time series will be so 'well-behaved';</li>
<li>there are different ways in which we can describe the trend and
periodicity (we have just used the loess smoothing functions for clear
visualization).</li>
</ul>
<p style="text-align: center;">
<span
style="font-family: serif; font-size:12pt; background-color: #ffff00;">This
ends our exploratory data analysis of time series, which leads us into
ARIMA forecast modelling.</span>
</p>
<hr style="height:2px; background-color:#003087;">
</div>
</div>
</div>
<div id="modelling-time-series-with-arima" class="section level1">
<h1>Modelling time series with ARIMA</h1>
<p>All the analysis of our data before ARIMA is really exploratory data
analysis of time series:</p>
<ul>
<li>Does our time series have periodicity?</li>
<li>Can we get stationarity with a moving average?</li>
<li>Does our time series have autocorrelation?</li>
<li>Can we get stationarity by differencing?</li>
</ul>
<p>All of these operations are possible components of
<strong>ARIMA</strong> models!</p>
<p><span style="color: #8000e0;"><strong>We recommend using the
<u>xts</u> format of a time series in ARIMA model functions and
forecasting</strong>.</span></p>
<div id="use-the-forecast-r-package-to-run-an-arima-model"
class="section level2">
<h2>Use the <code>forecast</code> R package to run an ARIMA model</h2>
<pre class="r"><code>auto.arima(soiltemp_T15_xts, max.p = 3, max.q = 3, max.d = 0, 
           seasonal = TRUE)</code></pre>
<pre><code>## Series: soiltemp_T15_xts 
## ARIMA(1,0,3) with non-zero mean 
## 
## Coefficients:
##          ar1     ma1     ma2     ma3     mean
##       0.9883  0.0923  0.0892  0.0999  15.0050
## s.e.  0.0041  0.0263  0.0255  0.0258   0.9301
## 
## sigma^2 = 0.1188:  log likelihood = -517.87
## AIC=1047.73   AICc=1047.79   BIC=1079.47</code></pre>
<p>The <code>auto.arima()</code> function runs a complex algorithm
(Hyndman <em>et al</em>. 2020) to automatically select the best ARIMA
model on the basis of the <strong>Aikake Information Criterion</strong>
(AIC), a statistic which estimates how much information is 'lost' in the
model compared with reality. The AIC combines how well the model
describes the data with a 'penalty' for increased complexity of the
model. Using AIC, a better fitting model might not be selected if it has
too many predictors. The best ARIMA models will have the
<strong>lowest</strong> AIC (or AICc) value.</p>
</div>
<div id="use-output-of-auto.arima-to-run-arima" class="section level2">
<h2>Use output of <code>auto.arima()</code> to run arima</h2>
<p>The <code>auto-arima()</code> algorithm is not perfect! – but it does
provide a starting point for examining ARIMA models.</p>
<p>The output of the <code>auto-arima()</code> function includes a
description of the best model the algorithm found, shown as
<code>ARIMA(p,d,q)</code>. The p,d,q refer to</p>
<table border="0" cellpadding="2" cellspacing="2" style="width: 85%;">
<tr style="background-color: #e0e0e0;">
<td>
<strong>Parameter</strong>
</td>
<td>
<strong>Meaning</strong>
</td>
<td>
<strong>Informed by</strong>
</td>
</tr>
<tr>
<td>
p
</td>
<td>
The number of autoregressive predictors
</td>
<td>
Partial autocorrelation
</td>
</tr>
<tr style="background-color: #e0e0e0;">
<td>
d
</td>
<td>
The number of differencing steps
</td>
<td>
Stationarity tests ± differencing
</td>
</tr>
<tr>
<td>
q
</td>
<td>
The number of moving average predictors
</td>
<td>
Stationarity tests ± moving averages
</td>
</tr>
</table>
<p> <br> A periodic or <em>seasonal</em> ARIMA model (often called
SARIMA) has a more complex specification: <br>
<code>ARIMA(p,d,q)(P,D,Q)(n)</code> , <br> where the additional
parameters refer to the seasonality: <code>P</code> is the number of
seasonal autoregressive predictors, <code>D</code> the seasonal
differencing, <code>Q</code> the seasonal moving averages, and
<code>n</code> is the number of time steps per period/season.</p>
<div id="with-no-seasonality" class="section level3">
<h3>1. With no seasonality</h3>
<pre class="r"><code>am0 &lt;- arima(x = soiltemp_T15_xts, order = c(1,0,3))
summary(am0)
confint(am0)</code></pre>
<pre><code>## 
## Call:
## arima(x = soiltemp_T15_xts, order = c(1, 0, 3))
## 
## Coefficients:
##          ar1     ma1     ma2     ma3  intercept
##       0.9883  0.0923  0.0892  0.0999    15.0050
## s.e.  0.0041  0.0263  0.0255  0.0258     0.9301
## 
## sigma^2 estimated as 0.1184:  log likelihood = -517.87,  aic = 1047.73
## 
## Training set error measures:
##                        ME      RMSE       MAE         MPE     MAPE     MASE          ACF1
## Training set -0.005215705 0.3441525 0.2467179 -0.08670514 1.716531 0.980305 -0.0001019764
##                 2.5 %     97.5 %
## ar1        0.98017359  0.9963265
## ma1        0.04074353  0.1438382
## ma2        0.03916128  0.1392272
## ma3        0.04923344  0.1504821
## intercept 13.18199812 16.8279311</code></pre>
<p>The output from <code>summary(am0)</code> shows the values and
uncertainties of the model parameters
(<code>ar1, ma1, ma2, ma3, intercept</code>), the goodness-of-fit
parameters (we're interested in <code>aic</code>).</p>
<p><em>Note</em>: <code>ar</code> parameters are auto-regression
coefficients, and <code>ma</code> are moving average coefficients.</p>
<p>The output from <code>confint(am0)</code> is a table showing the 95%
confidence interval for the parameters. The confidence intervals should
not include zero! (if so, this would mean we can't be sure if the
parameter is useful or not).</p>
</div>
<div id="with-seasonality" class="section level3">
<h3>2. With seasonality</h3>
<pre class="r"><code>ff &lt;- findfrequency(soiltemp_T15_xts)
cat(&quot;Estimated time series frequency is&quot;,ff,&quot;\n&quot;)
am1 &lt;- arima(x = soiltemp_T15_xts, order = c(1,0,2),
             seasonal = list(order = c(1, 0, 1), period = ff))
summary(am1)
confint(am1)</code></pre>
<pre><code>## Estimated time series frequency is 24 
## 
## Call:
## arima(x = soiltemp_T15_xts, order = c(1, 0, 2), seasonal = list(order = c(1, 
##     0, 1), period = ff))
## 
## Coefficients:
##          ar1      ma1      ma2    sar1     sma1  intercept
##       0.9968  -0.1466  -0.0984  0.9998  -0.9856     14.829
## s.e.  0.0020   0.0268   0.0288  0.0004   0.0143     10.415
## 
## sigma^2 estimated as 0.09073:  log likelihood = -355.68,  aic = 725.35
## 
## Training set error measures:
##                       ME    RMSE       MAE        MPE     MAPE      MASE         ACF1
## Training set -0.01572894 0.30122 0.2169846 -0.1427709 1.504911 0.8621632 0.0006582706
##                2.5 %      97.5 %
## ar1        0.9928401  1.00080710
## ma1       -0.1990623 -0.09412079
## ma2       -0.1549117 -0.04197365
## sar1       0.9989639  1.00061967
## sma1      -1.0136981 -0.95746903
## intercept -5.5840446 35.24194848</code></pre>
<p><em>Note</em>: <code>sar</code> parameters are <em>seasonal</em>
auto-regression coefficients, and <code>sma</code> are <em>seasonal</em>
moving average coefficients.</p>
<p>The model which includes periodicity has the lowest AIC value (which
is not surprising, since the soil temperature data have clear
periodicity).</p>
<p>Checking residuals using the <code>checkresiduals()</code> function
from the <code>forecast</code> package is our best diagnostic tool to
assess the validity of our models. [This is a separate issue from how
well the model describes the data, measured by AIC.]</p>
<p>In the output (plot and text) from <code>checkresiduals()</code>: -
the residual plot (top) should look like white noise - the residuals
should not be autocorrelated (bottom left plot) - the p-value from the
Ljung-Box test should be &gt; 0.05 (text output) - the residuals should
be normally distributed (bottom right plot)</p>
<pre class="r"><code>checkresiduals(am0)</code></pre>
<div class="figure">
<img src="timeseries_files/figure-html/diagnostic-arima-1.png" alt="Figure 14: Residual diagnostic plots for a non-seasonal ARIMA model of the  soil temperature time series." width="70%" />
<p class="caption">
Figure 14: Residual diagnostic plots for a non-seasonal ARIMA model of
the soil temperature time series.
</p>
</div>
<pre><code>## 
##  Ljung-Box test
## 
## data:  Residuals from ARIMA(1,0,3) with non-zero mean
## Q* = 35.092, df = 6, p-value = 4.136e-06
## 
## Model df: 4.   Total lags used: 10</code></pre>
<pre class="r"><code>checkresiduals(am1)</code></pre>
<div class="figure">
<img src="timeseries_files/figure-html/diagnostic-sarima-1.png" alt="Figure 15: Residual diagnostic plots for a seasonal ARIMA (SARIMA) model of the  soil temperature time series." width="70%" />
<p class="caption">
Figure 15: Residual diagnostic plots for a seasonal ARIMA (SARIMA) model
of the soil temperature time series.
</p>
</div>
<pre><code>## 
##  Ljung-Box test
## 
## data:  Residuals from ARIMA(1,0,2)(1,0,1)[24] with non-zero mean
## Q* = 20.04, df = 5, p-value = 0.001228
## 
## Model df: 5.   Total lags used: 10</code></pre>
<p>
 
</p>
<p>In both the diagnostic plots (Figure 14 and Figure 15) the residuals
appear to be random and normally distributed. There seems to be a more
obvious autocorrelation of residuals for the non-seasonal model,
reinforcing the conclusion from the AIC value that the
<strong>seasonal</strong> ARIMA model is the most appropriate.</p>
</div>
</div>
<div id="use-the-arima-model-to-produce-a-forecast-using-both-models"
class="section level2">
<h2>Use the ARIMA model to produce a forecast using both models</h2>
<p>The whole point of generating ARIMA models is so that we can attempt
to forecast the future trajectory of our time series based on our
existing time series data.</p>
<p>To do this, we use the appropriately named <code>forecast()</code>
function from the <code>forecast</code> package. The option
<code>h =</code> is to specify how long we want to forecast for after
the end of our data – in this case 168 hours (same units as the
periodicity from <code>findfrequency()</code>), that is, one week.</p>
<table border="1">
<tr>
<td style="background-color:#ffffe0; padding:8px;">
<p><span style="font-size:12pt;"><strong>One of the problems</strong> we
often run into is the issue of <strong>irregular time series</strong>,
where the observations are not taken at regularly-spaced time intervals.
Features of time series, such as periodicity and the length of time we
want to forecast for, may be incorrect if our time series is
irregular.</span></p>
It is possible to "fill in" a time series so we have observations
regularly spaced in time, using interpolation or numerical filtering
methods. We won't be covering these methods here.
</td>
</tr>
</table>
<p>
 
</p>
<pre class="r"><code>fc0 &lt;- forecast(am0, h = 168)
fc1 &lt;- forecast(am1, h = 168)</code></pre>
<div id="then-look-at-forecasts-with-plots" class="section level3">
<h3>Then, look at forecasts with plots</h3>
<pre class="r"><code>par(mfrow = c(2, 1), cex.main = 0.9, mar = c(0,3,0,1), oma = c(3,0,1,0),
    mgp=c(1.6,0.3,0), tcl=0.2, font.lab=2)
plot(fc0,ylab = &quot;Temperature (\u00B0C)&quot;,
     fcol = 4, xlab=&quot;&quot;, main = &quot;&quot;, xaxt=&quot;n&quot;)
lines(soiltemp_T15_zoo, col = &quot;grey70&quot;)
mtext(&quot;ARIMA with no seasonality&quot;, 1, -2.2, adj = 0.1, font = 2)
mtext(am0$call, 1, -1, adj = 0.1, col = 4, cex = 0.9, 
      family=&quot;mono&quot;, font = 2)
mtext(&quot;(a)&quot;, 3, -1.2, cex = 1.2, font = 2, adj = 0.95)

plot(fc1,ylab = &quot;Temperature (\u00B0C)&quot;, main = &quot;&quot;, fcol = 3)
lines(soiltemp$conc, col = &quot;grey70&quot;)
mtext(&quot;Time since start (seconds)&quot;, 1, 1.7, cex = 1.2, font = 2)
mtext(paste(&quot;ARIMA with&quot;,am1$arma[5],&quot;h periodicity&quot;),
      side = 1, line = -2.2, adj = 0.1, font = 2)
mtext(am1$call, 1, -1, adj = 0.1, col = 3, cex = 0.9, family=&quot;mono&quot;)
mtext(&quot;(b)&quot;, 3, -1.2, cex = 1.2, font = 2, adj = 0.95)</code></pre>
<div class="figure" style="text-align: center">
<img src="timeseries_files/figure-html/forecast-plots-1.png" alt="Figure 16: Time series forecasts for soil temperature, based on (a) a non-seasonal ARIMA model and (b) a seasonal ARIMA model." width="70%" />
<p class="caption">
Figure 16: Time series forecasts for soil temperature, based on (a) a
non-seasonal ARIMA model and (b) a seasonal ARIMA model.
</p>
</div>
<p>
 
</p>
<p>From the two plots in Figure 16, we observe that the seasonal ARIMA
model seems to reflect the form of the original data much better, by
simulating the diurnal fluctuations in soil temperature. Although the
forecasting uncertainty shown by the shaded area in Figure 16 is large
for both types of ARIMA model, the interval seems smaller for the
seasonal ARIMA model (Figure 16(b)).</p>
<p>We can also make a slightly 'prettier' time series forecast plot
using the <code>autoplot()</code> function from the <code>ggplot2</code>
package (Figure 17):</p>
<pre class="r"><code>require(ggplot2) # gives best results using autoplot(...)
autoplot(fc1)+
  ylab(&quot;Temperature (\u00B0C)&quot;) +
  xlab(paste(&quot;Time since&quot;,index(soiltemp_T15_zoo)[1],&quot;(s)&quot;)) +
  ggtitle(&quot;&quot;) +
  theme_bw()</code></pre>
<div class="figure" style="text-align: center">
<img src="timeseries_files/figure-html/forecast-ggplot-1.png" alt="Figure 17: Time series forecast for soil temperature, based on  a seasonal ARIMA model, plotted using the ggplot2 `autoplot()` function." width="70%" />
<p class="caption">
Figure 17: Time series forecast for soil temperature, based on a
seasonal ARIMA model, plotted using the ggplot2 <code>autoplot()</code>
function.
</p>
</div>
<p>
 
</p>
<p><span
style="font-family: serif; font-size: 14pt; background-color: #ffff00;">ARIMA
models are not the end of the time series modelling and forecasting
story!</span></p>
</div>
</div>
</div>
<div id="exponential-smoothing-models" class="section level1">
<h1>Exponential Smoothing Models</h1>
<p>Sometimes, ARIMA models may not be the best option, and another
commonly used method is <strong>exponential smoothing</strong>.</p>
<div id="try-an-exponential-smoothing-model" class="section level2">
<h2>Try an exponential smoothing model</h2>
<p>Check <code>help(forecast::ets)</code> to correctly specify the model
type using the <code>model =</code> option!</p>
<p>The easiest option (and the one used here) is to specify
<code>model = "ZZZ"</code>, which chooses the type of model
automatically.</p>
<pre class="r"><code>soiltemp_T15_ets &lt;- ets(soiltemp_T15_xts, model = &quot;ZZZ&quot;)
summary(soiltemp_T15_ets)</code></pre>
<pre><code>## ETS(A,Ad,N) 
## 
## Call:
##  ets(y = soiltemp_T15_xts, model = &quot;ZZZ&quot;) 
## 
##   Smoothing parameters:
##     alpha = 0.9999 
##     beta  = 0.1083 
##     phi   = 0.8 
## 
##   Initial states:
##     l = 20.2683 
##     b = -0.4487 
## 
##   sigma:  0.3482
## 
##      AIC     AICc      BIC 
## 7588.660 7588.718 7620.394 
## 
## Training set error measures:
##                        ME      RMSE       MAE         MPE     MAPE       MASE      ACF1
## Training set -0.003041526 0.3475639 0.2472475 -0.03856289 1.719534 0.01664266 0.0146761</code></pre>
<p>In this case the <code>ets()</code> function has automatically
selected a model (<code>ETS(A,Ad,N)</code>) with additive trend and
errors, but no seasonality. We don't do it here, but we could manually
select a model with seasonality included.</p>
<p>The default plot function in R can plot forecasts from exponential
smoothing models too (Figure 18).</p>
<pre class="r"><code>plot(forecast(soiltemp_T15_ets, h=168), col=3, 
     xlab = &quot;Time since start (s)&quot;, ylab = &quot;Temperature (\u00B0C)&quot;, main=&quot;&quot;)
mtext(names(soiltemp_T15_ets$par),3,seq(-1,-5,-1), adj = 0.7, col = 4, font = 3)
mtext(signif(soiltemp_T15_ets$par,3),3,seq(-1,-5,-1), adj = 0.8, col = 4, font = 3)</code></pre>
<div class="figure" style="text-align: center">
<img src="timeseries_files/figure-html/ets-forecast-1.png" alt="Figure 18: Forecast of soil temperature based on an automatically selected exponential smoothing model without a seasonal component." width="70%" />
<p class="caption">
Figure 18: Forecast of soil temperature based on an automatically
selected exponential smoothing model without a seasonal component.
</p>
</div>
<p>
 
</p>
<p>Exponential smoothing also <u>decomposes</u> time series in a
different way, into <em>level</em> and <em>slope</em> components (Figure
19).</p>
<pre class="r"><code>plot(soiltemp_T15_ets, col = 4, xlab = &quot;Time since start (s)&quot;) # ETS decomposition plots</code></pre>
<div class="figure" style="text-align: center">
<img src="timeseries_files/figure-html/ets-decomposition-1.png" alt="Figure 19: Exponential smoothing time series decomposition plots for soil temperature data." width="75%" />
<p class="caption">
Figure 19: Exponential smoothing time series decomposition plots for
soil temperature data.
</p>
</div>
<p>
 
</p>
<p style="text-align: center;">
<span style="font-family: serif; font-size: 13pt">(<em>Exponential
smoothing is maybe not so good for the soil temperature
data!</em>)</span>
</p>
</div>
</div>
<div id="references" class="section level1">
<h1>References</h1>
<p>Australian Government (2023). <a
href="https://www.waterquality.gov.au/anz-guidelines/monitoring/data-analysis/data-assess-change"
target="_blank">Assessment of change through monitoring data
analysis</a>, <strong>In</strong> <a
href="https://www.waterquality.gov.au/anz-guidelines"
target="_blank"><em>Australian &amp; New Zealand Guidelines for Fresh
and Marine Water Quality</em></a>, <a
href="https://www.waterquality.gov.au/anz-guidelines/monitoring/data-analysis/data-assess-change"
target="_blank">www.waterquality.gov.au/anz-guidelines/monitoring/data-analysis/data-assess-change</a>.</p>
<p>Department of Water (2015). <em>Calculating trends in nutrient
data</em>, Government of Western Australia, Perth. <a
href="https://water.wa.gov.au/__data/assets/pdf_file/0014/6800/Calculating-trends-in-nutrient-data-10-3-15.pdf"
target="_blank">water.wa.gov.au/.../Calculating-trends-in-nutrient-data-10-3-15.pdf</a>.</p>
<p>Hyndman R, Athanasopoulos G, Bergmeir C, Caceres G, Chhay L,
O'Hara-Wild M, Petropoulos F, Razbash S, Wang E, Yasmeen F (2022).
<em>forecast: Forecasting</em> <em>functions for time series and linear
models</em>. R package version 8.17.0, <a
href="http://pkg.robjhyndman.com/forecast/"
target="_blank">http://pkg.robjhyndman.com/forecast/</a>.</p>
<p>Long, J.D., Teetor, P., 2019. Time series analysis. Chapter 14,
<em>The R Cookbook</em>, Second Edition <a
href="https://rc2e.com/timeseriesanalysis"
target="_blank">https://rc2e.com/timeseriesanalysis</a>.</p>
<p>R Core Team (2022). <em>R: A language and environment for statistical
computing</em>. R Foundation for Statistical Computing, Vienna, Austria.
URL <a href="https://www.R-project.org/"
target="_blank">https://www.R-project.org/</a>.</p>
<p>Ryan, J.A. and Ulrich, J.M. (2020). <em>xts: eXtensible Time
Series</em>. R package version 0.12.1. <a
href="https://CRAN.R-project.org/package=xts"
target="_blank">https://CRAN.R-project.org/package=xts</a></p>
<p>Zeileis, A. and Grothendieck, G. (2005). zoo: S3 Infrastructure for
Regular and Irregular Time Series. <em>Journal of Statistical
Software</em>, <strong>14</strong>(6), 1-27. <a
href="https://doi.org/10.18637/jss.v014.i06"
target="_blank">doi:10.18637/jss.v014.i06</a></p>
</div>

<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<script src="site_libs/header-attrs-2.16/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/navigation-1.1/tabsets.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>










<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<hr />
<p><a href="https://creativecommons.org/licenses/by-sa/4.0/" target="_blank"><strong>CC-BY-SA</strong></a> • All content by <a href="https://github.com/Ratey-AtUWA" target="_blank">Ratey-AtUWA</a>. My <a href="https://www.uwa.edu.au/schools/agriculture-and-environment" target="_blank">employer</a> does not necessarily know about or endorse the content of this website.<br>
<span style="font-size:9pt">Created with <span style="font-family: monospace; background-color: #e8e8e8;">rmarkdown</span> in <a href="https://www.rstudio.com/" target="_blank"><span class="fa fa-registered"></span> RStudio</a> using the <span style="font-family: monospace; background-color: #e8e8e8;">cyborg</span> theme from <a href="https://bootswatch.com/" target="_blank"><span class="fa fa-swatchbook"></span> Bootswatch</a> via the <span style="font-family: monospace; background-color: #e8e8e8;">bslib</span> package, and <a href="https://fontawesome.com/v5/search?o=r&m=free" target="_blank"><span class="fa fa-font-awesome"></span> fontawesome v5 icons</a>.</span></p>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>



</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
