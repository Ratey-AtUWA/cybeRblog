<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>eDNA Data Analysis</title>

<script src="site_libs/header-attrs-2.16/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cerulean.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/tabwid-1.1.0/tabwid.css" rel="stylesheet" />
<link href="site_libs/tabwid-1.1.0/scrool.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>







<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">cyboRg</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fa fa-home"></span>
     
    Home
  </a>
</li>
<li>
  <a href="code.html">
    <span class="fa fa-project-diagram"></span>
     
    Code
  </a>
</li>
<li>
  <a href="rants.html">
    <span class="fa fa-bell"></span>
     
    Rants
  </a>
</li>
<li>
  <a href="about.html">
    <span class="fa fa-address-card"></span>
     
    About
  </a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="social.html">
    <span class="fa fa-twitter"></span>
     
    Social
  </a>
</li>
<li>
  <a href="work.html">
    <span class="fa fa-user-graduate"></span>
     
    UWA
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">eDNA Data Analysis</h1>

</div>


<p><em>Deirdre Gleeson and Andrew Rate</em><br> <em>School of
Agriculture and Environment, The University of Western
Australia</em></p>
<div id="learning-outcomes" class="section level2">
<h2>Learning Outcomes:</h2>
<ol style="list-style-type: decimal">
<li>Students are able to appropriately analyse data from an eDNA field
sampling campaign;</li>
<li>Students are able to interpret and understand statistical outputs
from the R package <span
style="font-family: monospace; background-color: #e8e8e8;">vegan</span>.</li>
</ol>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(vegan)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(flextable)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringr)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(magrittr) <span class="co"># for pipe syntax</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set_flextable_defaults</span>(<span class="at">theme_fun =</span> <span class="st">&quot;theme_zebra&quot;</span>, <span class="at">font.size =</span> <span class="dv">9</span>)</span></code></pre></div>
</div>
<div id="import-the-data" class="section level2">
<h2>Import the data</h2>
<p><strong>Notes</strong>:</p>
<ol style="list-style-type: decimal">
<li>This code imports the data from a file where the <strong>samples are
rows</strong> and the <strong>species are columns</strong>.</li>
<li>We convert the column <span
style="font-family: monospace; background-color: #e8e8e8;">Site</span>
to a <em>factor</em> (categorical information in R)</li>
</ol>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>eDNA2022 <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="at">file =</span> <span class="st">&quot;eDNA2022.csv&quot;</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>eDNA2022<span class="sc">$</span>Site <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(eDNA2022<span class="sc">$</span>Site)</span></code></pre></div>
<p>If you have <em>species</em> as rows and <em>samples</em> as columns,
we will need to do a bit of wrangling!</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>speciesAsRows <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="at">file =</span> <span class="st">&quot;speciesAsRows.csv&quot;</span>, <span class="at">row.names =</span> <span class="dv">1</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>speciesAsRows <span class="ot">&lt;-</span> <span class="fu">rbind</span>(<span class="fu">str_remove</span>(<span class="fu">colnames</span>(speciesAsRows), <span class="st">&quot;X&quot;</span>),</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>                       speciesAsRows)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="fu">row.names</span>(speciesAsRows)[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="st">&quot;SiteID&quot;</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>speciesAsRows <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(speciesAsRows) <span class="co"># convert to matrix for next step</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>speciesAsRows <span class="ot">&lt;-</span> <span class="fu">t</span>(speciesAsRows) <span class="co"># t() means transpose</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>eDNA2022 <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(speciesAsRows)</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>eDNA2022<span class="sc">$</span>Site <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(eDNA2022<span class="sc">$</span>Site)</span></code></pre></div>
</div>
<div id="list-of-all-the-species-and-their-common-names"
class="section level2">
<h2>List of all the species and their common names</h2>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>altnames <span class="ot">&lt;-</span> </span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="st">&quot;MosqFish&quot;</span>, <span class="st">&quot;Goby&quot;</span>, <span class="st">&quot;Mullet&quot;</span>, <span class="st">&quot;Bream&quot;</span>, <span class="st">&quot;BnjoFrog&quot;</span>, <span class="st">&quot;GToadlet&quot;</span>, <span class="st">&quot;MlrdDuck&quot;</span>,</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;SpotDove&quot;</span>, <span class="st">&quot;SwampHen&quot;</span>, <span class="st">&quot;Crake&quot;</span>, <span class="st">&quot;WFHeron&quot;</span>, <span class="st">&quot;Lorikeet&quot;</span>, <span class="st">&quot;Cattle&quot;</span>, <span class="st">&quot;Sheep&quot;</span>,</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Mouse&quot;</span>, <span class="st">&quot;Rat&quot;</span>, <span class="st">&quot;HydroidB&quot;</span>, <span class="st">&quot;HydroidO&quot;</span>, <span class="st">&quot;BwnJelly&quot;</span>, <span class="st">&quot;MoonJely&quot;</span>, <span class="st">&quot;Dog&quot;</span>)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>names_table <span class="ot">&lt;-</span> </span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="at">Taxonomic =</span> <span class="fu">gsub</span>(<span class="st">&quot;.&quot;</span>,<span class="st">&quot; &quot;</span>,<span class="fu">colnames</span>(eDNA2022[,<span class="dv">4</span><span class="sc">:</span><span class="dv">24</span>]), <span class="at">fixed =</span> T),</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">Common=</span><span class="fu">c</span>(<span class="st">&quot;Mosquito Fish&quot;</span>,<span class="st">&quot;Bridled Goby&quot;</span>,<span class="st">&quot;Gray Mullet&quot;</span>,<span class="st">&quot;Black Bream&quot;</span>,</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>                      <span class="st">&quot;Western Banjo Frog&quot;</span>, <span class="st">&quot;Gunther&#39;s Toadlet&quot;</span>, <span class="st">&quot;Mallard Duck&quot;</span>,</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>                      <span class="st">&quot;Spotted Turtle Dove&quot;</span>, <span class="st">&quot;Purple Swamphen&quot;</span>, <span class="st">&quot;Spotted Crake&quot;</span>,</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>                      <span class="st">&quot;White Faced Heron&quot;</span>, <span class="st">&quot;Rainbow Lorikeet&quot;</span>, <span class="st">&quot;Cattle&quot;</span>, <span class="st">&quot;Sheep&quot;</span>,</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>                      <span class="st">&quot;Mouse&quot;</span>, <span class="st">&quot;Rat&quot;</span>, <span class="st">&quot;HydroidB&quot;</span>, <span class="st">&quot;HydroidO&quot;</span>, <span class="st">&quot;Brown Jellyfish&quot;</span>,</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>                      <span class="st">&quot;Moon Jellyfish&quot;</span>, <span class="st">&quot;Domestic Dog&quot;</span>),</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>             <span class="at">Abbreviated=</span>altnames)</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a><span class="fu">flextable</span>(names_table,<span class="at">cwidth =</span> <span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">2</span>))</span></code></pre></div>
<template id="7fa25fdf-8979-4096-bb48-3de601dc0d1d"><style>
.tabwid table{
  border-spacing:0px !important;
  border-collapse:collapse;
  line-height:1;
  margin-left:auto;
  margin-right:auto;
  border-width: 0;
  display: table;
  border-color: transparent;
  caption-side: top;
}
.tabwid-caption-bottom table{
  caption-side: bottom;
}
.tabwid_left table{
  margin-left:0;
}
.tabwid_right table{
  margin-right:0;
}
.tabwid td {
    padding: 0;
}
.tabwid a {
  text-decoration: none;
}
.tabwid thead {
    background-color: transparent;
}
.tabwid tfoot {
    background-color: transparent;
}
.tabwid table tr {
background-color: transparent;
}
.katex-display {
    margin: 0 0 !important;
}
</style><div class="tabwid"><style>.cl-1a9d5224{}.cl-1a88efc8{font-family:'Arial';font-size:9pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-1a88efe6{font-family:'Arial';font-size:9pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-1a9074dc{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-1a90a9fc{width:3in;background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-1a90aa06{width:2in;background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-1a90aa1a{width:3in;background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-1a90aa1b{width:2in;background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-1a90aa24{width:3in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-1a90aa38{width:2in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table class='cl-1a9d5224'><thead><tr style="overflow-wrap:break-word;"><td class="cl-1a90a9fc"><p class="cl-1a9074dc"><span class="cl-1a88efc8">Taxonomic</span></p></td><td class="cl-1a90aa06"><p class="cl-1a9074dc"><span class="cl-1a88efc8">Common</span></p></td><td class="cl-1a90aa06"><p class="cl-1a9074dc"><span class="cl-1a88efc8">Abbreviated</span></p></td></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-1a90aa1a"><p class="cl-1a9074dc"><span class="cl-1a88efe6">Gambusia holbrooki</span></p></td><td class="cl-1a90aa1b"><p class="cl-1a9074dc"><span class="cl-1a88efe6">Mosquito Fish</span></p></td><td class="cl-1a90aa1b"><p class="cl-1a9074dc"><span class="cl-1a88efe6">MosqFish</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-1a90aa24"><p class="cl-1a9074dc"><span class="cl-1a88efe6">Arenigobius bifrenatus</span></p></td><td class="cl-1a90aa38"><p class="cl-1a9074dc"><span class="cl-1a88efe6">Bridled Goby</span></p></td><td class="cl-1a90aa38"><p class="cl-1a9074dc"><span class="cl-1a88efe6">Goby</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-1a90aa1a"><p class="cl-1a9074dc"><span class="cl-1a88efe6">Mugil cephalus</span></p></td><td class="cl-1a90aa1b"><p class="cl-1a9074dc"><span class="cl-1a88efe6">Gray Mullet</span></p></td><td class="cl-1a90aa1b"><p class="cl-1a9074dc"><span class="cl-1a88efe6">Mullet</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-1a90aa24"><p class="cl-1a9074dc"><span class="cl-1a88efe6">Acanthopagrus butcheri</span></p></td><td class="cl-1a90aa38"><p class="cl-1a9074dc"><span class="cl-1a88efe6">Black Bream</span></p></td><td class="cl-1a90aa38"><p class="cl-1a9074dc"><span class="cl-1a88efe6">Bream</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-1a90aa1a"><p class="cl-1a9074dc"><span class="cl-1a88efe6">Limnodynastes dorsalis</span></p></td><td class="cl-1a90aa1b"><p class="cl-1a9074dc"><span class="cl-1a88efe6">Western Banjo Frog</span></p></td><td class="cl-1a90aa1b"><p class="cl-1a9074dc"><span class="cl-1a88efe6">BnjoFrog</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-1a90aa24"><p class="cl-1a9074dc"><span class="cl-1a88efe6">Pseudophryne guentheri</span></p></td><td class="cl-1a90aa38"><p class="cl-1a9074dc"><span class="cl-1a88efe6">Gunther's Toadlet</span></p></td><td class="cl-1a90aa38"><p class="cl-1a9074dc"><span class="cl-1a88efe6">GToadlet</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-1a90aa1a"><p class="cl-1a9074dc"><span class="cl-1a88efe6">Anas platyrhynchos</span></p></td><td class="cl-1a90aa1b"><p class="cl-1a9074dc"><span class="cl-1a88efe6">Mallard Duck</span></p></td><td class="cl-1a90aa1b"><p class="cl-1a9074dc"><span class="cl-1a88efe6">MlrdDuck</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-1a90aa24"><p class="cl-1a9074dc"><span class="cl-1a88efe6">Spilopelia chinensis</span></p></td><td class="cl-1a90aa38"><p class="cl-1a9074dc"><span class="cl-1a88efe6">Spotted Turtle Dove</span></p></td><td class="cl-1a90aa38"><p class="cl-1a9074dc"><span class="cl-1a88efe6">SpotDove</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-1a90aa1a"><p class="cl-1a9074dc"><span class="cl-1a88efe6">Porphyrio porphyrio</span></p></td><td class="cl-1a90aa1b"><p class="cl-1a9074dc"><span class="cl-1a88efe6">Purple Swamphen</span></p></td><td class="cl-1a90aa1b"><p class="cl-1a9074dc"><span class="cl-1a88efe6">SwampHen</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-1a90aa24"><p class="cl-1a9074dc"><span class="cl-1a88efe6">Porzana tabuensis</span></p></td><td class="cl-1a90aa38"><p class="cl-1a9074dc"><span class="cl-1a88efe6">Spotted Crake</span></p></td><td class="cl-1a90aa38"><p class="cl-1a9074dc"><span class="cl-1a88efe6">Crake</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-1a90aa1a"><p class="cl-1a9074dc"><span class="cl-1a88efe6">Egretta novaehollandiae</span></p></td><td class="cl-1a90aa1b"><p class="cl-1a9074dc"><span class="cl-1a88efe6">White Faced Heron</span></p></td><td class="cl-1a90aa1b"><p class="cl-1a9074dc"><span class="cl-1a88efe6">WFHeron</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-1a90aa24"><p class="cl-1a9074dc"><span class="cl-1a88efe6">Trichoglossus rubritorquis</span></p></td><td class="cl-1a90aa38"><p class="cl-1a9074dc"><span class="cl-1a88efe6">Rainbow Lorikeet</span></p></td><td class="cl-1a90aa38"><p class="cl-1a9074dc"><span class="cl-1a88efe6">Lorikeet</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-1a90aa1a"><p class="cl-1a9074dc"><span class="cl-1a88efe6">Bos taurus</span></p></td><td class="cl-1a90aa1b"><p class="cl-1a9074dc"><span class="cl-1a88efe6">Cattle</span></p></td><td class="cl-1a90aa1b"><p class="cl-1a9074dc"><span class="cl-1a88efe6">Cattle</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-1a90aa24"><p class="cl-1a9074dc"><span class="cl-1a88efe6">Ovis sp </span></p></td><td class="cl-1a90aa38"><p class="cl-1a9074dc"><span class="cl-1a88efe6">Sheep</span></p></td><td class="cl-1a90aa38"><p class="cl-1a9074dc"><span class="cl-1a88efe6">Sheep</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-1a90aa1a"><p class="cl-1a9074dc"><span class="cl-1a88efe6">Mus musculus</span></p></td><td class="cl-1a90aa1b"><p class="cl-1a9074dc"><span class="cl-1a88efe6">Mouse</span></p></td><td class="cl-1a90aa1b"><p class="cl-1a9074dc"><span class="cl-1a88efe6">Mouse</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-1a90aa24"><p class="cl-1a9074dc"><span class="cl-1a88efe6">Rattus sp </span></p></td><td class="cl-1a90aa38"><p class="cl-1a9074dc"><span class="cl-1a88efe6">Rat</span></p></td><td class="cl-1a90aa38"><p class="cl-1a9074dc"><span class="cl-1a88efe6">Rat</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-1a90aa1a"><p class="cl-1a9074dc"><span class="cl-1a88efe6">Blackfordia polytentaculata</span></p></td><td class="cl-1a90aa1b"><p class="cl-1a9074dc"><span class="cl-1a88efe6">HydroidB</span></p></td><td class="cl-1a90aa1b"><p class="cl-1a9074dc"><span class="cl-1a88efe6">HydroidB</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-1a90aa24"><p class="cl-1a9074dc"><span class="cl-1a88efe6">Obelia bidentata</span></p></td><td class="cl-1a90aa38"><p class="cl-1a9074dc"><span class="cl-1a88efe6">HydroidO</span></p></td><td class="cl-1a90aa38"><p class="cl-1a9074dc"><span class="cl-1a88efe6">HydroidO</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-1a90aa1a"><p class="cl-1a9074dc"><span class="cl-1a88efe6">Phyllorhiza punctata</span></p></td><td class="cl-1a90aa1b"><p class="cl-1a9074dc"><span class="cl-1a88efe6">Brown Jellyfish</span></p></td><td class="cl-1a90aa1b"><p class="cl-1a9074dc"><span class="cl-1a88efe6">BwnJelly</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-1a90aa24"><p class="cl-1a9074dc"><span class="cl-1a88efe6">Aurelia sp </span></p></td><td class="cl-1a90aa38"><p class="cl-1a9074dc"><span class="cl-1a88efe6">Moon Jellyfish</span></p></td><td class="cl-1a90aa38"><p class="cl-1a9074dc"><span class="cl-1a88efe6">MoonJely</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-1a90aa1a"><p class="cl-1a9074dc"><span class="cl-1a88efe6">Canis lupus familiaris</span></p></td><td class="cl-1a90aa1b"><p class="cl-1a9074dc"><span class="cl-1a88efe6">Domestic Dog</span></p></td><td class="cl-1a90aa1b"><p class="cl-1a9074dc"><span class="cl-1a88efe6">Dog</span></p></td></tr></tbody></table></div></template>
<div class="flextable-shadow-host" id="6ebbd262-1e7c-473c-8394-e47bbd0f9af0"></div>
<script>
var dest = document.getElementById("6ebbd262-1e7c-473c-8394-e47bbd0f9af0");
var template = document.getElementById("7fa25fdf-8979-4096-bb48-3de601dc0d1d");
var caption = template.content.querySelector("caption");
var fantome = dest.attachShadow({mode: 'open'});
var templateContent = template.content;
fantome.appendChild(templateContent);
</script>

<hr>
<p>We need to make a subset of our imported data which contains just the
species presence/absence information (not sample IDs, sites, reps). We
also overwrite the original column names with abbreviated names for
better visualisation later.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>allSpecies <span class="ot">&lt;-</span> eDNA2022[,<span class="dv">4</span><span class="sc">:</span><span class="dv">24</span>] <span class="co"># not columns 1:3 which are sample IDs etc.</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(allSpecies) <span class="ot">&lt;-</span> names_table[,<span class="dv">3</span>]</span></code></pre></div>
</div>
<div id="difference-and-similarity-measures" class="section level2">
<h2>Difference and Similarity measures</h2>
<p>We start by assessing how similar or different our samples are – to
do this we need to set up a resemblance matrix. Ideally our 4 replicated
samples are more similar to one another than any other samples – but
with field sampling this is not always the case. To determine similarity
we need to use a similarity measure.</p>
<div id="similarity-measures" class="section level3">
<h3>Similarity Measures:</h3>
<p>A similarity measure is conventionally defined to take values between
0 and 100% (or 0 and 1) with the ends of the range representing the
extreme possibilities:</p>
<ul>
<li>Similarity = 100% (<em>or 1</em>) if two samples are totally
similar</li>
<li>Similarity = 0 if two samples are totally dissimilar</li>
</ul>
<p>What constitutes total similarity, and particularly total
dissimilarity, of two samples depends on the specific criteria that are
adopted. For example most biologists would feel that similarity should
equal zero when two samples have no species in common, and similarity
should equal 100% if two samples have identical entries. Similarities
are calculated between every pair of samples creating a similarity
matrix. There are a number of similarity measures (ways to calculate
similarity) which can be used to create this matrix.</p>
<p><strong>Bray Curtis</strong> and <strong>Jaccard</strong> are two
different similarity measures we can use -– both are commonly used in
ecology and have desirable properties -– similarity is calculated based
on the taxa that samples have in common. Similarity takes a value of 0
if two samples have no species in common and joint absences have no
effect (<em>i.e</em>. a taxon jointly absent in two samples does not
contribute to its similarity). The difference between them is that Bray
Curtis will use abundance information (where it is present) in assessing
similarity, whereas Jaccard converts abundances to binary (<em>i.e</em>.
0s and 1s, with 1 representing presence and 0 meaning absence) to assess
similarity. In our case it does not matter much which we use, since we
have already converted to binary – so let’s proceed with Jaccard.</p>
<p><strong>Ecological Question – If two samples have no taxa present
each does this make them more similar to one another?</strong></p>
<p>To assess similarity in the <span
style="font-family: monospace; background-color: #e8e8e8;">vegan</span>
<strong>R</strong> package carry out the following steps. The output
shows the first few rows and columns of the dissimilarity matrix; each
number represents the Jaccard distance between samples based on the
presence or absence of species.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>AF_diss_all <span class="ot">&lt;-</span> <span class="fu">vegdist</span>(allSpecies, </span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>                           <span class="at">distance =</span> <span class="st">&quot;jaccard&quot;</span>) <span class="co"># default is distance = &quot;bray&quot;</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co"># just look at the top corner of the dissimilarity matrix:</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>txt0 <span class="ot">&lt;-</span> <span class="fu">capture.output</span>(<span class="fu">print</span>(AF_diss_all, <span class="at">digits=</span><span class="dv">3</span>)); txt0[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>]; <span class="fu">rm</span>(txt0)</span></code></pre></div>
<pre><code>##         1      2      3      4      5      6      7      8      9     10     11     12     13 
## 2  0.0769                                                                                     
## 3  0.2727 0.1667                                                                              
## 4  0.0769 0.0000 0.1667                                                                       
## 5  0.3333 0.3846 0.6364 0.3846                                                                
## 6  0.3333 0.3846 0.6364 0.3846 0.0000                                                         
## 7  0.3333 0.3846 0.6364 0.3846 0.0000 0.0000                                                  
## 8  0.2727 0.3333 0.6000 0.3333 0.0909 0.0909 0.0909                                           
## 9  0.8000 0.6364 0.5556 0.6364 0.6000 0.6000 0.6000 0.7778                                    
## 10 0.6000 0.6364 0.5556 0.6364 0.6000 0.6000 0.6000 0.7778 0.2500                             
## 11 0.8000 0.6364 0.5556 0.6364 0.8000 0.8000 0.8000 1.0000 0.2500 0.2500</code></pre>
</div>
</div>
<div id="ordinations" class="section level1">
<h1>Ordinations</h1>
<p>Next we will construct our ordination – a procedure to visualise the
similarity matrix by simplifying (scaling) it into fewer dimensions than
our original data. This reduction of dimensions is useful as the
original data will have as many dimensions as there are species, which
is impossible to visualise! There are two different types of ordination
that we will use: <strong>Multi-Dimensional-Scaling</strong> (nmMDS) and
<strong>Principal Coordinates Analysis</strong> (PCO). If you have
previously used PCA -– Principal Component Analysis – you may be
familiar with ordination methods. PCA is useful for environmental
datasets -– these are represented by a similarity matrix derived via use
of Euclidean Distance as a measure of similarity. PCA is more suited to
environmental variables because of the type of data – there are no large
blocks of zeros (usually) and it is no longer necessary to select a
similarity measure that ignores joint absences. When looking at
ordination plots in general you should note that sample points that are
spatially located together share common characteristics and sample
points that are distantly located from one another share less
characteristics. This holds whether we are working with environmental
variables (pH, EC, moisture content, heavy metals <em>etc</em>.) or
species abundances.</p>
<p>The main difference between MDS and PCO relates to the underlying use
of the resemblance matrix.</p>
<p><strong>MDS</strong> takes the similarity measures calculated by
Jaccard or Bray Curtis and ranks them in order. Thus pairs are samples
are ranked according to highest to lowest similarity and are thus
plotted in multidimensional space. Since it uses the rank and not the
actual values, it’s commonly called “non-[para]metric” multi-dimensional
scaling, or <strong>nmMDS</strong>.</p>
<p><strong>PCO</strong> takes the actual values of the underlying
measure of similarity and plots pairs of samples in multi-dimensional
space. It will then look for the direction (vector) of greatest variance
in the multi-dimensional “cloud” of points, which becomes the first PCO
dimension. Successive dimensions explain the most possible remaining
variance, until all variance is accounted for. So, many PCO dimensions
are possible, but usually only the first 2 or 3 are useful for
visualizing our data.</p>
<p>For both types of ordinations the software attempts to preserve the
similarity of each pair of samples –- while this is feasible in
multidimensional space, in order for us to view the ordination we see
this in 2 or 3 dimensions -– thus the software attempts to preserve as
much as is feasible of the sample pair similarity as calculated –- but
in reality we need to consider how much the 2- dimensional view is a
true representation of the data set. In nmMDS we use the <em>stress</em>
value to evaluate this, in PCO we can plot multiple axes, <em>i.e</em>.
axis 1 <em>vs</em>. axis 2, axis 2 <em>vs</em>. axis 3 and so on. The
amount of variance explained in each PCO dimension is called the
<em>eigenvalue</em>, and the output will include these values; the
greater the eigenvalue, the more useful a PCO dimension is. In practice,
much of the variability is often explained in the first two axes
(<em>i.e</em>. 2 dimensions) and we will limit our analysis to these
axes for this dataset.</p>
<div id="non-metric-multidimensional-scaling-nmmds"
class="section level2">
<h2>Non-metric multidimensional scaling (nmMDS)</h2>
<p>In vegan this is done using the <span
style="font-family: monospace; background-color: #e8e8e8;">metaMDS()</span>
function. We need to specify an input matrix of just the species data
(<em>e.g</em>. <span style="font-family: monospace;">allSpecies</span>
which we made earlier). The default is to find 2 dimensions (<span
style="font-family: monospace;">k</span>) using a Bray-Curtis
dissimilarity matrix, but we can set these options to different values
using <span style="font-family: monospace; background-color: #e8e8e8;">k
=</span> and <span
style="font-family: monospace; background-color: #e8e8e8;">distance
=</span> options. The dissimilarity matrix is calculated within the
<span
style="font-family: monospace; background-color: #e8e8e8;">metaMDS()</span>
function, so for consistency we set <span
style="font-family: monospace; background-color: #e8e8e8;">distance =
“jaccard”</span>.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># default with 2 dimensions</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>AF_nmds_all <span class="ot">&lt;-</span> <span class="fu">metaMDS</span>(allSpecies, <span class="at">distance =</span> <span class="st">&quot;jaccard&quot;</span>)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 3 dimensions for comparison</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>AF_nmds_all3 <span class="ot">&lt;-</span> <span class="fu">metaMDS</span>(allSpecies, <span class="at">k=</span><span class="dv">3</span>, <span class="at">distance =</span> <span class="st">&quot;jaccard&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># show output for 2 nmMDS dimensions</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>AF_nmds_all</span></code></pre></div>
<pre><code>## 
## Call:
## metaMDS(comm = allSpecies, distance = &quot;jaccard&quot;) 
## 
## global Multidimensional Scaling using monoMDS
## 
## Data:     allSpecies 
## Distance: jaccard 
## 
## Dimensions: 2 
## Stress:     0.1554552 
## Stress type 1, weak ties
## Two convergent solutions found after 20 tries
## Scaling: centring, PC rotation, halfchange scaling 
## Species: expanded scores based on &#39;allSpecies&#39;</code></pre>
<p>The 2D stress value is <span class="math inline">\(\approx\)</span>
0.16. This can be interpreted as follows:</p>
<p><img src="vegan_files/figure-html/unnamed-chunk-3-1.png" width="50%" style="display: block; margin: auto;" /></p>
<p>The stress value is relatively high as we are dealing with a large
number of samples with lots of 1s and 0s in a 2 dimensional space –
resulting in a challenging similarity environment.</p>
<p><span class="math inline">\(\Rightarrow\)</span> Check the stress
value of the 3-D ordination – is it lower? Remember that we made this
object in the code block above:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>AF_nmds_all3</span></code></pre></div>
<p>The following plot mimics the nmmds plot in Deirdre’s handout (note
that the sign of dimension MDS2 is reversed)</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">palette</span>(<span class="fu">c</span>(<span class="st">&quot;black&quot;</span>,<span class="st">&quot;grey60&quot;</span>,<span class="st">&quot;grey42&quot;</span>,</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>          <span class="fu">rainbow</span>(<span class="dv">4</span>,<span class="at">v=</span><span class="fl">0.75</span>,<span class="at">end=</span><span class="fl">0.25</span>),<span class="fu">rainbow</span>(<span class="dv">4</span>,<span class="at">v=</span><span class="fl">0.75</span>,<span class="at">start=</span><span class="fl">0.45</span>,<span class="at">end=</span><span class="fl">0.8</span>)))</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(AF_nmds_all<span class="sc">$</span>points, <span class="at">pch=</span><span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">21</span><span class="sc">:</span><span class="dv">25</span>, <span class="dv">2</span>),<span class="dv">21</span>)[eDNA2022<span class="sc">$</span>Site], </span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">1.6</span>,<span class="fl">2.2</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="fl">1.2</span>,<span class="sc">-</span><span class="fl">1.2</span>), </span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">bg=</span><span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">11</span>)[eDNA2022<span class="sc">$</span>Site], </span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">cex =</span> <span class="fl">1.4</span>, <span class="at">main =</span> <span class="st">&quot;All species&quot;</span>, <span class="at">col.main =</span> <span class="st">&quot;steelblue&quot;</span>)</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(AF_nmds_all<span class="sc">$</span>points, <span class="at">labels=</span>eDNA2022<span class="sc">$</span>SiteID, <span class="at">cex=</span><span class="fl">0.9</span>, <span class="at">pos =</span> <span class="dv">4</span>, </span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;black&quot;</span>,<span class="st">&quot;grey40&quot;</span>,<span class="st">&quot;grey70&quot;</span>,</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>           <span class="fu">rainbow</span>(<span class="dv">4</span>,<span class="at">v=</span><span class="fl">0.75</span>,<span class="at">end=</span><span class="fl">0.25</span>),</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>           <span class="fu">rainbow</span>(<span class="dv">4</span>,<span class="at">v=</span><span class="fl">0.75</span>,<span class="at">start=</span><span class="fl">0.45</span>,<span class="at">end=</span><span class="fl">0.8</span>))[eDNA2022<span class="sc">$</span>Site])</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(AF_nmds_all, <span class="at">display =</span> <span class="st">&quot;species&quot;</span>, <span class="at">col =</span> <span class="st">&quot;#80008080&quot;</span>, <span class="at">font=</span><span class="dv">3</span>, <span class="at">cex =</span> <span class="fl">1.1</span>)</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomright&quot;</span>, <span class="at">inset =</span> <span class="fl">0.01</span>, <span class="at">box.col =</span> <span class="dv">3</span>, <span class="at">ncol =</span> <span class="dv">4</span>, <span class="at">title =</span> <span class="st">&quot;Site&quot;</span>, </span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">legend =</span> <span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">11</span>), <span class="at">pch=</span><span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">21</span><span class="sc">:</span><span class="dv">25</span>, <span class="dv">2</span>),<span class="dv">21</span>), </span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">pt.bg =</span> <span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">11</span>), <span class="at">pt.cex =</span> <span class="fl">1.4</span>, <span class="at">cex =</span> <span class="fl">1.2</span>)</span></code></pre></div>
<p><img src="vegan_files/figure-html/plot%20nmds%20all%20Jaccard%202D-1.png" width="70%" /></p>
<p>You can play around with the code to make additional changes – you
won’t break it by trying so play around as much as you like. You will
notice that there are only 2 points for Site 2 – this is because the
points are overlaid on top of one another – as we are picking up only a
few taxa some of the samples are very similar to one another. However we
can generally see that there are sample groupings and that likely
location has an effect (i.e. samples that are from the same location are
closer together). We will test this statistically a little later.</p>
</div>
<div id="principal-coordinates-analysis" class="section level2">
<h2>Principal Coordinates Analysis</h2>
<p>In the ‘vegan’ package we use Weighted classical multidimensional
scaling, also known as <em>Weighted Principal Coordinates Analysis</em>.
This is implemented using the function <span
style="font-family: monospace; background-color: #e8e8e8;">wcmdscale()</span>.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>AF_pco_all <span class="ot">&lt;-</span> <span class="fu">wcmdscale</span>(<span class="fu">vegdist</span>(allSpecies), <span class="at">eig=</span><span class="cn">TRUE</span>)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>AF_pco_all</span></code></pre></div>
<pre><code>## Call: wcmdscale(d = vegdist(allSpecies), eig = TRUE)
## 
##           Inertia Rank
## Total       8.169     
## Real       10.272   15
## Imaginary  -2.103   21
## 
## Results have 44 points, 15 axes
## 
## Eigenvalues:
##  [1]  3.377  2.101  1.537  1.297  0.613  0.434  0.342  0.214  0.158  0.100  0.039  0.032  0.014
## [14]  0.010  0.004 -0.006 -0.007 -0.009 -0.016 -0.021 -0.027 -0.035 -0.046 -0.052 -0.059 -0.074
## [27] -0.089 -0.094 -0.115 -0.134 -0.143 -0.163 -0.190 -0.212 -0.242 -0.371
## 
## Weights: Constant</code></pre>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(AF_pco_all)</span></code></pre></div>
<p><img src="vegan_files/figure-html/basic%20pco%20plot-1.png" width="480" /></p>
<p>This is a basic PCO plot based on all species, showing the locations
of individual samples by row number.</p>
<p>We can make more informative plots by using the information stored in
the output object (<span
style="font-family: monospace; background-color: #e8e8e8;">AF_pco_all</span>).</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">palette</span>(<span class="fu">c</span>(<span class="st">&quot;black&quot;</span>,<span class="st">&quot;grey60&quot;</span>,<span class="st">&quot;grey42&quot;</span>,</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>          <span class="fu">rainbow</span>(<span class="dv">4</span>,<span class="at">v=</span><span class="fl">0.75</span>,<span class="at">end=</span><span class="fl">0.25</span>),<span class="fu">rainbow</span>(<span class="dv">4</span>,<span class="at">v=</span><span class="fl">0.75</span>,<span class="at">start=</span><span class="fl">0.45</span>,<span class="at">end=</span><span class="fl">0.8</span>)))</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">mgp =</span> <span class="fu">c</span>(<span class="fl">1.7</span>,<span class="fl">0.3</span>,<span class="dv">0</span>), <span class="at">tcl =</span> <span class="fl">0.25</span>, </span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">font.lab =</span> <span class="dv">2</span>)</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(AF_pco_all<span class="sc">$</span>points[,<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)], <span class="at">xlim =</span> <span class="fu">c</span>(<span class="fl">0.4</span>,<span class="sc">-</span><span class="fl">0.6</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="fl">0.4</span>,<span class="sc">-</span><span class="fl">0.6</span>), </span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">pch=</span><span class="dv">3</span>, <span class="at">cex =</span> <span class="fl">0.5</span>, <span class="at">col =</span> <span class="st">&quot;grey&quot;</span>)</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(AF_pco_all<span class="sc">$</span>points[,<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)],<span class="at">labels =</span> eDNA2022<span class="sc">$</span>SiteID,</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">col=</span><span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">11</span>)[eDNA2022<span class="sc">$</span>Site])</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span>(<span class="st">&quot;first and second dimensions&quot;</span>)</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(AF_pco_all<span class="sc">$</span>points[,<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>)], <span class="at">xlim =</span> <span class="fu">c</span>(<span class="fl">0.4</span>,<span class="sc">-</span><span class="fl">0.6</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="fl">0.4</span>,<span class="sc">-</span><span class="fl">0.6</span>), </span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>     <span class="at">pch=</span><span class="dv">4</span>, <span class="at">cex =</span> <span class="fl">0.5</span>, <span class="at">col =</span> <span class="st">&quot;grey&quot;</span>)</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(AF_pco_all<span class="sc">$</span>points[,<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>)],<span class="at">labels =</span> eDNA2022<span class="sc">$</span>SiteID,</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>     <span class="at">col=</span><span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">11</span>)[eDNA2022<span class="sc">$</span>Site])</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span>(<span class="st">&quot;first and third dimensions&quot;</span>)</span></code></pre></div>
<p><img src="vegan_files/figure-html/better%20pco%20plot%20using%20base%20R-1.png" width="70%" /></p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>AF_pco_scores <span class="ot">&lt;-</span> <span class="fu">scores</span>(AF_pco_all)</span></code></pre></div>
</div>
</div>
<div id="permanova" class="section level1">
<h1>PERMANOVA</h1>
<p>In order to test where location has a significant effect on the taxa
at our field site we need to run an ANOVA – however as we have multiple
species to test together we cannot run a basic ANOVA – we must run a
multivariate permutational ANOVA or <strong>PERMANOVA</strong>.</p>
<p>PERMANOVA shares some resemblance to ANOVA where they both measure
the sum-of-squares within and between groups, and make use of an F test
to compare within-group to between-group variance. However, while ANOVA
bases the significance of the result on assumption of normality,
PERMANOVA draws tests for significance by comparing the actual F test
result to that gained from random permutations of the objects between
the groups. Moreover, whilst PERMANOVA tests for similarity based on a
chosen distance measure, ANOVA tests for similarity of the group
averages.</p>
<p>We could calculate a univariate measure of diversity (a Simpson or
Shannon index, for example) and run an ANOVA on that univariate value.
In doing so, however, we are reducing the complex dataset to a
simplified version and losing discrete information in the process.
Remember that ANOVA also has an underlying assumption of normality -–
generally speaking, biological species data are not normally distributed
and thus do not satisfy this assumption. This makes applying a
permutational ANOVA a much better option. Before the advent of
computational capacity a permutational ANOVA would have taken quite some
time to run –- luckily now it only takes a matter of seconds to minutes
depending on the complexity of the dataset.</p>
<p>In the <span
style="font-family: monospace; background-color: #e8e8e8;">vegan</span>
package, the <span
style="font-family: monospace; background-color: #e8e8e8;">adonis2()</span>
function implements Permutational Multivariate Analysis of Variance
Using Distance Matrices (<em>i.e</em>. PERMANOVA).</p>
<p>We use a formula in the <span
style="font-family: monospace; background-color: #e8e8e8;">adonis2()</span>
function which expresses the community matrix (<em>i.e</em>. the columns
of species presence or absence) as a function of a factor (in this case,
<span style="font-family: monospace;">Site</span>).</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>AF_permanova_all <span class="ot">&lt;-</span> <span class="fu">adonis2</span>(eDNA2022[,<span class="dv">4</span><span class="sc">:</span><span class="dv">24</span>] <span class="sc">~</span> Site, <span class="at">data =</span> eDNA2022,</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>                            <span class="at">permutations =</span> <span class="dv">9999</span>)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>AF_permanova_all</span></code></pre></div>
<pre><code>## Permutation test for adonis under reduced model
## Terms added sequentially (first to last)
## Permutation: free
## Number of permutations: 9999
## 
## adonis2(formula = eDNA2022[, 4:24] ~ Site, data = eDNA2022, permutations = 9999)
##          Df SumOfSqs      R2      F Pr(&gt;F)    
## Site     10   7.7475 0.94839 60.644  1e-04 ***
## Residual 33   0.4216 0.05161                  
## Total    43   8.1691 1.00000                  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>P value by permutation = <span
style="font-family: monospace; background-color: #e8e8e8;">0.0001</span>
indicating a significant effect of location on the community composition
of our samples. Note that 9999 permutations were undertaken to arrive at
this value.</p>
<p>The output from the <span
style="font-family: monospace; background-color: #e8e8e8;">pairwise.adonis2()</span>
function is quite lengthy (to see it, run <span
style="font-family: monospace; background-color: #e8e8e8;">print(AF_PWpermanova_all)</span>).
We can tidy it up for clarity with a custom function (<span
style="font-family: monospace; background-color: #f8c8f8;">plainPW()</span>
– see below).</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">&quot;FUN_pairwise_adonis2.R&quot;</span>)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">&quot;FUN_plain_pairwise.R&quot;</span>)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>AF_PWpermanova_all <span class="ot">&lt;-</span> <span class="fu">pairwise.adonis2</span>(eDNA2022[,<span class="dv">4</span><span class="sc">:</span><span class="dv">24</span>] <span class="sc">~</span> Site, <span class="at">data =</span> eDNA2022)</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>AF_plainPW_all <span class="ot">&lt;-</span> <span class="fu">plainPW</span>(AF_PWpermanova_all)</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(AF_plainPW_all)[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="st">&quot;Comparison.between.Sites&quot;</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a><span class="fu">flextable</span>(AF_plainPW_all, <span class="at">cwidth =</span> <span class="fu">c</span>(<span class="fl">1.5</span>,<span class="dv">1</span>)) <span class="sc">%&gt;%</span> <span class="fu">align</span>(<span class="at">align=</span><span class="st">&quot;center&quot;</span>)</span></code></pre></div>
<template id="edcf02d7-bde0-45f0-a962-e2f7b5a9be24"><style>
.tabwid table{
  border-spacing:0px !important;
  border-collapse:collapse;
  line-height:1;
  margin-left:auto;
  margin-right:auto;
  border-width: 0;
  display: table;
  border-color: transparent;
  caption-side: top;
}
.tabwid-caption-bottom table{
  caption-side: bottom;
}
.tabwid_left table{
  margin-left:0;
}
.tabwid_right table{
  margin-right:0;
}
.tabwid td {
    padding: 0;
}
.tabwid a {
  text-decoration: none;
}
.tabwid thead {
    background-color: transparent;
}
.tabwid tfoot {
    background-color: transparent;
}
.tabwid table tr {
background-color: transparent;
}
.katex-display {
    margin: 0 0 !important;
}
</style><div class="tabwid"><style>.cl-1eb461e0{}.cl-1e9f8374{font-family:'Arial';font-size:9pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-1e9f8388{font-family:'Arial';font-size:9pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-1ea75e32{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-1ea75e46{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-1ea75e50{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-1ea78916{width:1.5in;background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-1ea78920{width:1in;background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-1ea7892a{width:1.5in;background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-1ea78934{width:1in;background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-1ea7893e{width:1.5in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-1ea78948{width:1in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table class='cl-1eb461e0'><thead><tr style="overflow-wrap:break-word;"><td class="cl-1ea78916"><p class="cl-1ea75e32"><span class="cl-1e9f8374">Comparison.between.Sites</span></p></td><td class="cl-1ea78920"><p class="cl-1ea75e46"><span class="cl-1e9f8374">P_value</span></p></td></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-1ea7892a"><p class="cl-1ea75e50"><span class="cl-1e9f8388">1_vs_2</span></p></td><td class="cl-1ea78934"><p class="cl-1ea75e50"><span class="cl-1e9f8388">0.026</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-1ea7893e"><p class="cl-1ea75e50"><span class="cl-1e9f8388">1_vs_3</span></p></td><td class="cl-1ea78948"><p class="cl-1ea75e50"><span class="cl-1e9f8388">0.026</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-1ea7892a"><p class="cl-1ea75e50"><span class="cl-1e9f8388">1_vs_4</span></p></td><td class="cl-1ea78934"><p class="cl-1ea75e50"><span class="cl-1e9f8388">0.026</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-1ea7893e"><p class="cl-1ea75e50"><span class="cl-1e9f8388">1_vs_5</span></p></td><td class="cl-1ea78948"><p class="cl-1ea75e50"><span class="cl-1e9f8388">0.033</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-1ea7892a"><p class="cl-1ea75e50"><span class="cl-1e9f8388">1_vs_6</span></p></td><td class="cl-1ea78934"><p class="cl-1ea75e50"><span class="cl-1e9f8388">0.027</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-1ea7893e"><p class="cl-1ea75e50"><span class="cl-1e9f8388">1_vs_7</span></p></td><td class="cl-1ea78948"><p class="cl-1ea75e50"><span class="cl-1e9f8388">0.031</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-1ea7892a"><p class="cl-1ea75e50"><span class="cl-1e9f8388">1_vs_8</span></p></td><td class="cl-1ea78934"><p class="cl-1ea75e50"><span class="cl-1e9f8388">0.028</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-1ea7893e"><p class="cl-1ea75e50"><span class="cl-1e9f8388">1_vs_9</span></p></td><td class="cl-1ea78948"><p class="cl-1ea75e50"><span class="cl-1e9f8388">0.032</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-1ea7892a"><p class="cl-1ea75e50"><span class="cl-1e9f8388">1_vs_10</span></p></td><td class="cl-1ea78934"><p class="cl-1ea75e50"><span class="cl-1e9f8388">0.026</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-1ea7893e"><p class="cl-1ea75e50"><span class="cl-1e9f8388">1_vs_11</span></p></td><td class="cl-1ea78948"><p class="cl-1ea75e50"><span class="cl-1e9f8388">0.030</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-1ea7892a"><p class="cl-1ea75e50"><span class="cl-1e9f8388">2_vs_3</span></p></td><td class="cl-1ea78934"><p class="cl-1ea75e50"><span class="cl-1e9f8388">0.021</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-1ea7893e"><p class="cl-1ea75e50"><span class="cl-1e9f8388">2_vs_4</span></p></td><td class="cl-1ea78948"><p class="cl-1ea75e50"><span class="cl-1e9f8388">0.034</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-1ea7892a"><p class="cl-1ea75e50"><span class="cl-1e9f8388">2_vs_5</span></p></td><td class="cl-1ea78934"><p class="cl-1ea75e50"><span class="cl-1e9f8388">0.028</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-1ea7893e"><p class="cl-1ea75e50"><span class="cl-1e9f8388">2_vs_6</span></p></td><td class="cl-1ea78948"><p class="cl-1ea75e50"><span class="cl-1e9f8388">0.028</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-1ea7892a"><p class="cl-1ea75e50"><span class="cl-1e9f8388">2_vs_7</span></p></td><td class="cl-1ea78934"><p class="cl-1ea75e50"><span class="cl-1e9f8388">0.029</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-1ea7893e"><p class="cl-1ea75e50"><span class="cl-1e9f8388">2_vs_8</span></p></td><td class="cl-1ea78948"><p class="cl-1ea75e50"><span class="cl-1e9f8388">0.034</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-1ea7892a"><p class="cl-1ea75e50"><span class="cl-1e9f8388">2_vs_9</span></p></td><td class="cl-1ea78934"><p class="cl-1ea75e50"><span class="cl-1e9f8388">0.028</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-1ea7893e"><p class="cl-1ea75e50"><span class="cl-1e9f8388">2_vs_10</span></p></td><td class="cl-1ea78948"><p class="cl-1ea75e50"><span class="cl-1e9f8388">0.020</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-1ea7892a"><p class="cl-1ea75e50"><span class="cl-1e9f8388">2_vs_11</span></p></td><td class="cl-1ea78934"><p class="cl-1ea75e50"><span class="cl-1e9f8388">0.029</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-1ea7893e"><p class="cl-1ea75e50"><span class="cl-1e9f8388">3_vs_4</span></p></td><td class="cl-1ea78948"><p class="cl-1ea75e50"><span class="cl-1e9f8388">0.033</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-1ea7892a"><p class="cl-1ea75e50"><span class="cl-1e9f8388">3_vs_5</span></p></td><td class="cl-1ea78934"><p class="cl-1ea75e50"><span class="cl-1e9f8388">0.027</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-1ea7893e"><p class="cl-1ea75e50"><span class="cl-1e9f8388">3_vs_6</span></p></td><td class="cl-1ea78948"><p class="cl-1ea75e50"><span class="cl-1e9f8388">0.023</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-1ea7892a"><p class="cl-1ea75e50"><span class="cl-1e9f8388">3_vs_7</span></p></td><td class="cl-1ea78934"><p class="cl-1ea75e50"><span class="cl-1e9f8388">0.026</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-1ea7893e"><p class="cl-1ea75e50"><span class="cl-1e9f8388">3_vs_8</span></p></td><td class="cl-1ea78948"><p class="cl-1ea75e50"><span class="cl-1e9f8388">0.022</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-1ea7892a"><p class="cl-1ea75e50"><span class="cl-1e9f8388">3_vs_9</span></p></td><td class="cl-1ea78934"><p class="cl-1ea75e50"><span class="cl-1e9f8388">0.043</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-1ea7893e"><p class="cl-1ea75e50"><span class="cl-1e9f8388">3_vs_10</span></p></td><td class="cl-1ea78948"><p class="cl-1ea75e50"><span class="cl-1e9f8388">0.022</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-1ea7892a"><p class="cl-1ea75e50"><span class="cl-1e9f8388">3_vs_11</span></p></td><td class="cl-1ea78934"><p class="cl-1ea75e50"><span class="cl-1e9f8388">0.034</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-1ea7893e"><p class="cl-1ea75e50"><span class="cl-1e9f8388">4_vs_5</span></p></td><td class="cl-1ea78948"><p class="cl-1ea75e50"><span class="cl-1e9f8388">0.024</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-1ea7892a"><p class="cl-1ea75e50"><span class="cl-1e9f8388">4_vs_6</span></p></td><td class="cl-1ea78934"><p class="cl-1ea75e50"><span class="cl-1e9f8388">0.028</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-1ea7893e"><p class="cl-1ea75e50"><span class="cl-1e9f8388">4_vs_7</span></p></td><td class="cl-1ea78948"><p class="cl-1ea75e50"><span class="cl-1e9f8388">0.033</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-1ea7892a"><p class="cl-1ea75e50"><span class="cl-1e9f8388">4_vs_8</span></p></td><td class="cl-1ea78934"><p class="cl-1ea75e50"><span class="cl-1e9f8388">0.020</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-1ea7893e"><p class="cl-1ea75e50"><span class="cl-1e9f8388">4_vs_9</span></p></td><td class="cl-1ea78948"><p class="cl-1ea75e50"><span class="cl-1e9f8388">0.022</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-1ea7892a"><p class="cl-1ea75e50"><span class="cl-1e9f8388">4_vs_10</span></p></td><td class="cl-1ea78934"><p class="cl-1ea75e50"><span class="cl-1e9f8388">0.021</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-1ea7893e"><p class="cl-1ea75e50"><span class="cl-1e9f8388">4_vs_11</span></p></td><td class="cl-1ea78948"><p class="cl-1ea75e50"><span class="cl-1e9f8388">0.037</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-1ea7892a"><p class="cl-1ea75e50"><span class="cl-1e9f8388">5_vs_6</span></p></td><td class="cl-1ea78934"><p class="cl-1ea75e50"><span class="cl-1e9f8388">0.029</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-1ea7893e"><p class="cl-1ea75e50"><span class="cl-1e9f8388">5_vs_7</span></p></td><td class="cl-1ea78948"><p class="cl-1ea75e50"><span class="cl-1e9f8388">0.038</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-1ea7892a"><p class="cl-1ea75e50"><span class="cl-1e9f8388">5_vs_8</span></p></td><td class="cl-1ea78934"><p class="cl-1ea75e50"><span class="cl-1e9f8388">0.030</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-1ea7893e"><p class="cl-1ea75e50"><span class="cl-1e9f8388">5_vs_9</span></p></td><td class="cl-1ea78948"><p class="cl-1ea75e50"><span class="cl-1e9f8388">0.028</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-1ea7892a"><p class="cl-1ea75e50"><span class="cl-1e9f8388">5_vs_10</span></p></td><td class="cl-1ea78934"><p class="cl-1ea75e50"><span class="cl-1e9f8388">0.026</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-1ea7893e"><p class="cl-1ea75e50"><span class="cl-1e9f8388">5_vs_11</span></p></td><td class="cl-1ea78948"><p class="cl-1ea75e50"><span class="cl-1e9f8388">0.021</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-1ea7892a"><p class="cl-1ea75e50"><span class="cl-1e9f8388">6_vs_7</span></p></td><td class="cl-1ea78934"><p class="cl-1ea75e50"><span class="cl-1e9f8388">0.031</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-1ea7893e"><p class="cl-1ea75e50"><span class="cl-1e9f8388">6_vs_8</span></p></td><td class="cl-1ea78948"><p class="cl-1ea75e50"><span class="cl-1e9f8388">0.036</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-1ea7892a"><p class="cl-1ea75e50"><span class="cl-1e9f8388">6_vs_9</span></p></td><td class="cl-1ea78934"><p class="cl-1ea75e50"><span class="cl-1e9f8388">0.027</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-1ea7893e"><p class="cl-1ea75e50"><span class="cl-1e9f8388">6_vs_10</span></p></td><td class="cl-1ea78948"><p class="cl-1ea75e50"><span class="cl-1e9f8388">0.059</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-1ea7892a"><p class="cl-1ea75e50"><span class="cl-1e9f8388">6_vs_11</span></p></td><td class="cl-1ea78934"><p class="cl-1ea75e50"><span class="cl-1e9f8388">0.040</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-1ea7893e"><p class="cl-1ea75e50"><span class="cl-1e9f8388">7_vs_8</span></p></td><td class="cl-1ea78948"><p class="cl-1ea75e50"><span class="cl-1e9f8388">0.028</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-1ea7892a"><p class="cl-1ea75e50"><span class="cl-1e9f8388">7_vs_9</span></p></td><td class="cl-1ea78934"><p class="cl-1ea75e50"><span class="cl-1e9f8388">0.036</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-1ea7893e"><p class="cl-1ea75e50"><span class="cl-1e9f8388">7_vs_10</span></p></td><td class="cl-1ea78948"><p class="cl-1ea75e50"><span class="cl-1e9f8388">0.025</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-1ea7892a"><p class="cl-1ea75e50"><span class="cl-1e9f8388">7_vs_11</span></p></td><td class="cl-1ea78934"><p class="cl-1ea75e50"><span class="cl-1e9f8388">0.020</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-1ea7893e"><p class="cl-1ea75e50"><span class="cl-1e9f8388">8_vs_9</span></p></td><td class="cl-1ea78948"><p class="cl-1ea75e50"><span class="cl-1e9f8388">0.029</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-1ea7892a"><p class="cl-1ea75e50"><span class="cl-1e9f8388">8_vs_10</span></p></td><td class="cl-1ea78934"><p class="cl-1ea75e50"><span class="cl-1e9f8388">0.021</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-1ea7893e"><p class="cl-1ea75e50"><span class="cl-1e9f8388">8_vs_11</span></p></td><td class="cl-1ea78948"><p class="cl-1ea75e50"><span class="cl-1e9f8388">0.042</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-1ea7892a"><p class="cl-1ea75e50"><span class="cl-1e9f8388">9_vs_10</span></p></td><td class="cl-1ea78934"><p class="cl-1ea75e50"><span class="cl-1e9f8388">0.031</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-1ea7893e"><p class="cl-1ea75e50"><span class="cl-1e9f8388">9_vs_11</span></p></td><td class="cl-1ea78948"><p class="cl-1ea75e50"><span class="cl-1e9f8388">0.030</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-1ea7892a"><p class="cl-1ea75e50"><span class="cl-1e9f8388">10_vs_11</span></p></td><td class="cl-1ea78934"><p class="cl-1ea75e50"><span class="cl-1e9f8388">0.025</span></p></td></tr></tbody></table></div></template>
<div class="flextable-shadow-host" id="07e6a222-6d02-4365-9724-ad4359d3a909"></div>
<script>
var dest = document.getElementById("07e6a222-6d02-4365-9724-ad4359d3a909");
var template = document.getElementById("edcf02d7-bde0-45f0-a962-e2f7b5a9be24");
var caption = template.content.querySelector("caption");
var fantome = dest.attachShadow({mode: 'open'});
var templateContent = template.content;
fantome.appendChild(templateContent);
</script>

<p><strong>Notes</strong>:</p>
<ul>
<li>the pairwise Adonis2 source code is by Pedro Martinez Arbizu at <a
href="https://github.com/pmartinezarbizu/pairwiseAdonis"
class="uri">https://github.com/pmartinezarbizu/pairwiseAdonis</a>.</li>
<li>The code for the <span
style="font-family: monospace;">plainPW()</span> function is as
follows:</li>
</ul>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># function inputs output object from Pedro Martinez Arbizu&#39;s pairwise.adonis2()</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="co"># code at https://github.com/pmartinezarbizu/pairwiseAdonis</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>plainPW <span class="ot">&lt;-</span> <span class="cf">function</span>(PWobj) {</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  UL_PW_perm <span class="ot">&lt;-</span> <span class="fu">unlist</span>(PWobj) <span class="co"># convert list to long named vector</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>  names_PW_perm <span class="ot">&lt;-</span> <span class="fu">names</span>(UL_PW_perm) <span class="co"># extract the names...</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>  rows_pvals <span class="ot">&lt;-</span> <span class="fu">grep</span>(<span class="st">&quot;F)1&quot;</span>,names_PW_perm) <span class="co"># find the rows we need</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>  justThePW <span class="ot">&lt;-</span> <span class="co"># use the row indices to find the rows in the long vector</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">data.frame</span>(<span class="at">Comparison =</span> <span class="fu">str_remove</span>(<span class="fu">names</span>(UL_PW_perm[rows_pvals]),</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>                                       <span class="fu">fixed</span>(<span class="st">&quot;.Pr(&gt;F)1&quot;</span>)),</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>               <span class="at">P_value =</span> <span class="fu">as.numeric</span>(UL_PW_perm[rows_pvals]))</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(justThePW) <span class="co"># and the resulting data frame is the output!</span></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="extras" class="section level1">
<h1>Extras</h1>
<div
id="stress-plot-for-nmmds-based-on-jaccard-dissimilarities-all-species"
class="section level3">
<h3>Stress plot for nmMDS based on Jaccard dissimilarities, all
species</h3>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">stressplot</span>(AF_nmds_all, <span class="at">main=</span><span class="st">&quot;Stress plot&quot;</span>)</span></code></pre></div>
<p><img src="vegan_files/figure-html/unnamed-chunk-6-1.png" width="576" /></p>
</div>
<div id="analysis-with-just-the-aquatic-species" class="section level2">
<h2>Analysis with just the aquatic species</h2>
<p>These are: <em>Gambusia holbrooki, Arenigobius bifrenatus, Mugil
cephalus, Acanthopagrus butcheri, Limnodynastes dorsalis, Pseudophryne
guentheri, Blackfordia polytentaculata, Obelia bidentata, Phyllorhiza
punctata, Aurelia sp.</em></p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>fish <span class="ot">&lt;-</span> allSpecies[,<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>,<span class="dv">17</span><span class="sc">:</span><span class="dv">20</span>)]</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(fish)</span></code></pre></div>
<pre><code>##   MosqFish Goby Mullet Bream BnjoFrog GToadlet HydroidB HydroidO BwnJelly MoonJely
## 1        1    0      0     0        1        0        0        0        0        0
## 2        1    0      0     0        1        1        0        0        0        0
## 3        1    0      0     0        0        1        0        0        0        0
## 4        1    0      0     0        1        1        0        0        0        0
## 5        1    0      0     0        1        0        0        0        0        0
## 6        1    0      0     0        1        0        0        0        0        0</code></pre>
<div id="for-interest-look-at-the-dissimilarity-matrix"
class="section level3">
<h3>for interest look at the dissimilarity matrix</h3>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>AF_diss_aquat <span class="ot">&lt;-</span> <span class="fu">vegdist</span>(fish, </span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>                           <span class="at">distance =</span> <span class="st">&quot;bray&quot;</span>)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>txt0 <span class="ot">&lt;-</span> <span class="fu">capture.output</span>(<span class="fu">print</span>(AF_diss_aquat,<span class="at">digits=</span><span class="dv">3</span>));txt0[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>];<span class="fu">rm</span>(txt0)</span></code></pre></div>
<pre><code>##         1      2      3      4      5      6      7      8      9     10     11     12     13 
## 2  0.2000                                                                                     
## 3  0.5000 0.2000                                                                              
## 4  0.2000 0.0000 0.2000                                                                       
## 5  0.0000 0.2000 0.5000 0.2000                                                                
## 6  0.0000 0.2000 0.5000 0.2000 0.0000                                                         
## 7  0.0000 0.2000 0.5000 0.2000 0.0000 0.0000                                                  
## 8  0.0000 0.2000 0.5000 0.2000 0.0000 0.0000 0.0000                                           
## 9  0.5000 0.2000 0.0000 0.2000 0.5000 0.5000 0.5000 0.5000                                    
## 10 0.3333 0.5000 0.3333 0.5000 0.3333 0.3333 0.3333 0.3333 0.3333                             
## 11 1.0000 0.5000 0.3333 0.5000 1.0000 1.0000 1.0000 1.0000 0.3333 1.0000</code></pre>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>AF_nmds_aquat <span class="ot">&lt;-</span> <span class="fu">metaMDS</span>(fish, <span class="at">trymax =</span> <span class="dv">500</span>, </span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>                           <span class="at">distance =</span> <span class="st">&quot;jaccard&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>AF_nmds_aquat</span></code></pre></div>
<pre><code>## 
## Call:
## metaMDS(comm = fish, distance = &quot;jaccard&quot;, trymax = 500) 
## 
## global Multidimensional Scaling using monoMDS
## 
## Data:     fish 
## Distance: jaccard 
## 
## Dimensions: 2 
## Stress:     0.08664754 
## Stress type 1, weak ties
## Two convergent solutions found after 20 tries
## Scaling: centring, PC rotation, halfchange scaling 
## Species: expanded scores based on &#39;fish&#39;</code></pre>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(AF_nmds_aquat, <span class="at">type=</span><span class="st">&quot;p&quot;</span>,<span class="at">display =</span> <span class="st">&quot;sites&quot;</span>, <span class="at">cex =</span> <span class="fl">1.2</span>)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(AF_nmds_aquat, <span class="at">display =</span> <span class="st">&quot;species&quot;</span>, <span class="at">col =</span> <span class="st">&quot;dodgerblue&quot;</span>, <span class="at">cex =</span> <span class="fl">0.8</span>)</span></code></pre></div>
<p><img src="vegan_files/figure-html/plot%20nmds%20aquat%20Bray-1.png" width="480" /></p>
</div>
<div id="alternative-to-vegan-plots" class="section level3">
<h3>alternative to vegan plots</h3>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">palette</span>(<span class="fu">c</span>(<span class="st">&quot;black&quot;</span>,<span class="st">&quot;grey80&quot;</span>,<span class="st">&quot;grey92&quot;</span>,</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>          <span class="fu">rainbow</span>(<span class="dv">4</span>,<span class="at">s=</span><span class="fl">0.5</span>,<span class="at">end=</span><span class="fl">0.25</span>),<span class="fu">rainbow</span>(<span class="dv">4</span>,<span class="at">s=</span><span class="fl">0.5</span>,<span class="at">start=</span><span class="fl">0.45</span>,<span class="at">end=</span><span class="fl">0.8</span>)))</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(AF_nmds_aquat<span class="sc">$</span>points, <span class="at">pch=</span><span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">21</span><span class="sc">:</span><span class="dv">25</span>, <span class="dv">2</span>),<span class="dv">21</span>)[eDNA2022<span class="sc">$</span>Site], </span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">1.2</span>,<span class="fl">1.8</span>), </span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">bg =</span> <span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">11</span>)[eDNA2022<span class="sc">$</span>Site], </span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">cex =</span> <span class="fl">1.4</span>, <span class="at">col.main =</span> <span class="st">&quot;steelblue&quot;</span>, <span class="at">main =</span> <span class="st">&quot;Just aquatic species&quot;</span>)</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(AF_nmds_aquat<span class="sc">$</span>points, <span class="at">pos =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">4</span>),<span class="dv">4</span>)[eDNA2022<span class="sc">$</span>Site], </span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">labels=</span>eDNA2022<span class="sc">$</span>SiteID, <span class="at">cex=</span><span class="dv">1</span>, </span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;black&quot;</span>,<span class="st">&quot;grey40&quot;</span>,<span class="st">&quot;grey70&quot;</span>,</span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>           <span class="fu">rainbow</span>(<span class="dv">4</span>,<span class="at">v=</span><span class="fl">0.75</span>,<span class="at">end=</span><span class="fl">0.25</span>),</span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>           <span class="fu">rainbow</span>(<span class="dv">4</span>,<span class="at">v=</span><span class="fl">0.75</span>,<span class="at">start=</span><span class="fl">0.45</span>,<span class="at">end=</span><span class="fl">0.8</span>))[eDNA2022<span class="sc">$</span>Site])</span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(AF_nmds_aquat, <span class="at">display =</span> <span class="st">&quot;species&quot;</span>, <span class="at">col =</span> <span class="st">&quot;grey33&quot;</span>, <span class="at">font=</span><span class="dv">3</span>, <span class="at">cex =</span> <span class="fl">0.9</span>)</span></code></pre></div>
<p><img src="vegan_files/figure-html/alt1%20to%20vegan%20nmds%20plots-1.png" width="480" /></p>
</div>
</div>
<div id="detrended-correspondence-analysis---all-species"
class="section level2">
<h2>Detrended correspondence analysis - all species</h2>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>AF_dca_all <span class="ot">&lt;-</span> <span class="fu">decorana</span>(allSpecies)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>AF_dca_all</span></code></pre></div>
<pre><code>## 
## Call:
## decorana(veg = allSpecies) 
## 
## Detrended correspondence analysis with 26 segments.
## Rescaling of axes with 4 iterations.
## 
##                   DCA1   DCA2   DCA3    DCA4
## Eigenvalues     0.5537 0.3602 0.2545 0.17011
## Decorana values 0.5632 0.3154 0.1915 0.07493
## Axis lengths    3.2842 2.6926 2.1577 1.75539</code></pre>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(AF_dca_all)</span></code></pre></div>
<p><img src="vegan_files/figure-html/decorana%20plot-1.png" width="480" /></p>
</div>
<div
id="for-comparison-if-wanted-nmmds-again-with-bray-curtis-distances"
class="section level2">
<h2>For comparison if wanted: nmMDS again with Bray-Curtis
distances</h2>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>AF_nmds_all_B <span class="ot">&lt;-</span> <span class="fu">metaMDS</span>(allSpecies) <span class="co"># uses Bray by default</span></span></code></pre></div>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>AF_nmds_all_B</span></code></pre></div>
<pre><code>## 
## Call:
## metaMDS(comm = allSpecies) 
## 
## global Multidimensional Scaling using monoMDS
## 
## Data:     allSpecies 
## Distance: bray 
## 
## Dimensions: 2 
## Stress:     0.1554552 
## Stress type 1, weak ties
## Two convergent solutions found after 20 tries
## Scaling: centring, PC rotation, halfchange scaling 
## Species: expanded scores based on &#39;allSpecies&#39;</code></pre>
<p>The results should be identical to nmMDS with Jaccard, since the
community matrix is already converted to presence-absence (binary ones
and zeros).</p>
</div>
</div>

<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<script src="site_libs/header-attrs-2.16/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/navigation-1.1/tabsets.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>










<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<hr />
<p><a href="https://creativecommons.org/licenses/by-sa/4.0/" target="_blank"><strong>CC-BY-SA</strong></a> • All content by Ratey-AtUWA. My employer does not necessarily know about or endorse the content of this website.</p>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>



</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
